{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"PersonaMate Documentation","text":"<p>Welcome to the PersonaMate documentation! PersonaMate is a personal knowledge graph assistant that uses AI and Model Context Protocol (MCP) to manage personal contact data and relationships.</p> <p> </p>"},{"location":"#quick-links","title":"\ud83d\ude80 Quick Links","text":""},{"location":"#quick-start","title":"Quick Start","text":"<p>Get PersonaMate running in minutes with our automated deployment script.</p> <p>\u2192 Get Started</p>"},{"location":"#deployment","title":"Deployment","text":"<p>Comprehensive deployment guide with troubleshooting and advanced configuration.</p> <p>\u2192 Deploy</p>"},{"location":"#contributing","title":"Contributing","text":"<p>Learn how to contribute to PersonaMate with our developer guide.</p> <p>\u2192 Contribute</p>"},{"location":"#mcp-protocol","title":"MCP Protocol","text":"<p>Understand the Model Context Protocol interface - tools, resources, and prompts.</p> <p>\u2192 Learn More</p>"},{"location":"#key-features","title":"\u2728 Key Features","text":"<ul> <li>\ud83e\udd16 MCP Protocol: Standard interface for AI assistants</li> <li>\ud83d\udcac OpenWebUI: Modern chat interface (optional)</li> <li>\ud83d\udd78\ufe0f Neo4j Graph: Powerful relationship modeling</li> <li>\ud83d\udc33 Docker: Easy deployment and scaling</li> <li>\ud83d\udd27 Modular Tools: Extensible functionality</li> <li>\u2705 Comprehensive Tests: 20 automated tests with CI/CD</li> <li>\ud83d\udcca Graph Visualization: Neo4j Browser integration</li> </ul>"},{"location":"#what-is-personamate","title":"\ud83c\udfaf What is PersonaMate?","text":"<p>PersonaMate is an intelligent personal knowledge graph that helps you:</p> <ul> <li>Manage Contacts: Store and retrieve person information with rich details</li> <li>Track Relationships: Model and visualize connections between people</li> <li>Query Your Network: Use natural language to explore your contact graph</li> <li>Integrate with AI: Expose data through Model Context Protocol for AI assistants</li> </ul>"},{"location":"#architecture-overview","title":"\ud83c\udfd7\ufe0f Architecture Overview","text":"<pre><code>graph LR\n    A[User/AI Client] --&gt; B[MCP Server]\n    B --&gt; C[PersonaMate Tools]\n    C --&gt; D[Neo4j Database]\n    B --&gt; E[OpenWebUI]\n    E --&gt; A</code></pre> <p>Core Components:</p> <ul> <li>MCP Server: FastMCP-based server exposing tools and resources</li> <li>Tools: Modular operations for managing persons and relationships</li> <li>Neo4j: Graph database for storing entities and relationships</li> <li>OpenWebUI: Optional web interface for chat interactions</li> </ul>"},{"location":"#getting-started","title":"\ud83d\udea6 Getting Started","text":"<p>Choose your path:</p> \ud83c\udfaf End User\ud83d\udd27 Developer\ud83d\ude80 DevOps <p>Want to use PersonaMate right away?</p> <ol> <li>Install Docker Desktop</li> <li>Run the deployment script:    <pre><code># Windows\n.\\deploy.ps1\n\n# Linux/macOS\n./deploy.sh\n</code></pre></li> <li>Choose \"Full Stack\" for complete setup</li> <li>Access OpenWebUI at http://localhost:3000</li> </ol> <p>\u2192 Full Quick Start Guide</p> <p>Want to contribute or customize?</p> <ol> <li>Clone the repository</li> <li>Install dependencies: <code>pip install -r requirements.txt</code></li> <li>Set up pre-commit hooks: <code>pre-commit install</code></li> <li>Start services: <code>docker compose up -d neo4j mcp</code></li> <li>Run tests: <code>docker compose run --rm pytest pytest /app/test/python/ -v</code></li> </ol> <p>\u2192 Contributing Guide</p> <p>Want to deploy in production?</p> <ol> <li>Review deployment options</li> <li>Configure environment variables</li> <li>Set up monitoring and backups</li> <li>Scale services as needed</li> <li>Configure reverse proxy for HTTPS</li> </ol> <p>\u2192 Deployment Guide</p>"},{"location":"#documentation-structure","title":"\ud83d\udcda Documentation Structure","text":"<p>This documentation is organized into several sections:</p>"},{"location":"#getting-started_1","title":"Getting Started","text":"<p>Learn how to install, deploy, and use PersonaMate with step-by-step guides.</p> <ul> <li>Quick Start: Get running in 2 commands</li> <li>Deployment Guide: Full deployment with troubleshooting</li> <li>Docker Setup: Docker-specific configuration</li> </ul>"},{"location":"#development","title":"Development","text":"<p>Contribute to PersonaMate and understand the development workflow.</p> <ul> <li>Contributing Guide: How to contribute code</li> <li>CI/CD Pipeline: Automated testing and deployment</li> <li>Testing: Running and writing tests</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<p>Understand the technical design and implementation.</p> <ul> <li>MCP Protocol: Model Context Protocol specification</li> <li>Project Structure: Code organization</li> </ul>"},{"location":"#mcp-reference","title":"MCP Reference","text":"<p>Technical reference for PersonaMate's Model Context Protocol interface.</p> <ul> <li>Tools: Available MCP tools</li> <li>Resources: MCP resources and prompts</li> </ul>"},{"location":"#need-help","title":"\ud83c\udd98 Need Help?","text":"<ul> <li>\ud83d\udcd6 Check the Deployment Guide for troubleshooting</li> <li>\ud83d\udcac Open an issue on GitHub</li> <li>\ud83d\udd0d Search the documentation using the search bar above</li> </ul>"},{"location":"#license","title":"\ud83d\udcc4 License","text":"<p>PersonaMate is open source software. See the LICENSE file for details.</p> <p>Ready to get started? Choose a guide above or jump to the Quick Start \u2192</p>"},{"location":"contributing/","title":"Contributing to PersonaMate","text":"<p>Thank you for your interest in contributing to PersonaMate! This guide will help you get started.</p>"},{"location":"contributing/#quick-start-for-contributors","title":"\ud83d\ude80 Quick Start for Contributors","text":""},{"location":"contributing/#1-fork-and-clone","title":"1. Fork and Clone","text":"<pre><code># Fork the repository on GitHub, then:\ngit clone https://github.com/YOUR_USERNAME/PersonaMate.git\ncd PersonaMate\ngit checkout -b feature/your-feature-name\n</code></pre>"},{"location":"contributing/#2-set-up-development-environment","title":"2. Set Up Development Environment","text":"<p>Option A: With Pre-commit Hooks (Recommended) <pre><code># Install dependencies\npip install -r requirements.txt\n\n# Install pre-commit hooks\npre-commit install\n\n# Now formatting happens automatically on commit!\n</code></pre></p> <p>Option B: Manual Formatting <pre><code># Install dependencies\npip install -r requirements.txt\n\n# Format manually before committing\nblack src/python test/python --line-length=120\n</code></pre></p>"},{"location":"contributing/#3-start-development-services","title":"3. Start Development Services","text":"<pre><code># Start Neo4j for testing\ndocker compose up -d neo4j\n\n# Or use full deployment\n./deploy.sh mcp-only\n</code></pre>"},{"location":"contributing/#testing-your-changes","title":"\ud83e\uddea Testing Your Changes","text":""},{"location":"contributing/#run-all-tests","title":"Run All Tests","text":"<pre><code># In Docker (recommended - matches CI environment)\ndocker compose up -d neo4j mcp\ndocker compose run --rm pytest pytest /app/test/python/ -v\n\n# Locally (if you have environment set up)\npytest test/python/ -v\n</code></pre>"},{"location":"contributing/#run-specific-tests","title":"Run Specific Tests","text":"<pre><code># MCP integration tests\ndocker compose run --rm pytest pytest /app/test/python/test_mcp_integration.py -v\n\n# Tool implementation tests\ndocker compose run --rm pytest pytest /app/test/python/test_tools.py -v\n\n# With coverage\ndocker compose run --rm pytest pytest /app/test/python/ -v --cov=/app/src/python --cov-report=term\n</code></pre>"},{"location":"contributing/#test-a-specific-function","title":"Test a Specific Function","text":"<pre><code>docker compose run --rm pytest pytest /app/test/python/test_tools.py::TestPersonalDataTool::test_fetch_person_data_existing -v\n</code></pre>"},{"location":"contributing/#code-style-and-formatting","title":"\ud83d\udc85 Code Style and Formatting","text":""},{"location":"contributing/#automatic-formatting","title":"Automatic Formatting","text":"<p>PersonaMate uses black for consistent code formatting.</p> <p>Pre-commit hooks (runs on <code>git commit</code>): <pre><code>pre-commit install              # One-time setup\n# Now formatting happens automatically!\n</code></pre></p> <p>Manual formatting: <pre><code># Format all Python code\nblack src/python test/python --line-length=120\n\n# Check without modifying\nblack src/python test/python --line-length=120 --check\n\n# Run all pre-commit checks\npre-commit run --all-files\n</code></pre></p> <p>CI auto-format: If you don't format locally, the CI pipeline will automatically format your code and commit it back when you push.</p>"},{"location":"contributing/#code-style-rules","title":"Code Style Rules","text":"<ul> <li>Line length: 120 characters</li> <li>Style: Black default (PEP 8 compliant)</li> <li>Imports: Sorted with isort (black profile)</li> <li>Docstrings: Google style preferred</li> <li>Type hints: Encouraged for new code</li> </ul>"},{"location":"contributing/#commit-message-guidelines","title":"\ud83d\udcdd Commit Message Guidelines","text":"<p>Use conventional commits format:</p> <pre><code>type(scope): subject\n\nbody (optional)\n</code></pre> <p>Types: - <code>feat</code>: New feature - <code>fix</code>: Bug fix - <code>docs</code>: Documentation changes - <code>style</code>: Code style changes (formatting, etc.) - <code>refactor</code>: Code refactoring - <code>test</code>: Adding or updating tests - <code>chore</code>: Maintenance tasks</p> <p>Examples: <pre><code>git commit -m \"feat(tools): add delete_person tool\"\ngit commit -m \"fix(mcp): handle empty person name in fetch\"\ngit commit -m \"docs: update deployment guide with new options\"\ngit commit -m \"test: add integration test for relationship cycles\"\n</code></pre></p>"},{"location":"contributing/#project-structure","title":"\ud83c\udfd7\ufe0f Project Structure","text":"<pre><code>PersonaMate/\n\u251c\u2500\u2500 src/python/\n\u2502   \u251c\u2500\u2500 mcp_server.py          # MCP server entry point\n\u2502   \u251c\u2500\u2500 tools/                 # Tool implementations\n\u2502   \u2502   \u251c\u2500\u2500 personalDataTool.py\n\u2502   \u2502   \u2514\u2500\u2500 linkingTool.py\n\u2502   \u2514\u2500\u2500 utils/                 # Utility modules\n\u2502       \u251c\u2500\u2500 neo4j_graph.py\n\u2502       \u2514\u2500\u2500 helper.py\n\u251c\u2500\u2500 test/python/\n\u2502   \u251c\u2500\u2500 test_mcp_integration.py\n\u2502   \u2514\u2500\u2500 test_tools.py\n\u2514\u2500\u2500 .github/workflows/\n    \u2514\u2500\u2500 ci.yml                 # CI/CD pipeline\n</code></pre>"},{"location":"contributing/#what-to-contribute","title":"\ud83c\udfaf What to Contribute","text":""},{"location":"contributing/#good-first-issues","title":"Good First Issues","text":"<ul> <li>Add new tool functions</li> <li>Improve error messages</li> <li>Add more test cases</li> <li>Update documentation</li> <li>Fix typos</li> </ul>"},{"location":"contributing/#feature-ideas","title":"Feature Ideas","text":"<ul> <li>Additional MCP tools (e.g., search, analytics)</li> <li>Enhanced Neo4j queries</li> <li>New relationship types</li> <li>Export/import functionality</li> <li>Advanced graph algorithms</li> </ul>"},{"location":"contributing/#testing","title":"Testing","text":"<ul> <li>Add edge case tests</li> <li>Improve test coverage</li> <li>Performance benchmarks</li> <li>Integration tests</li> </ul>"},{"location":"contributing/#pull-request-process","title":"\u2705 Pull Request Process","text":"<ol> <li> <p>Update your branch with latest main:    <pre><code>git fetch upstream\ngit rebase upstream/main\n</code></pre></p> </li> <li> <p>Ensure all tests pass:    <pre><code>docker compose run --rm pytest pytest /app/test/python/ -v\n</code></pre></p> </li> <li> <p>Update documentation if needed:</p> </li> <li>Update README.md for user-facing changes</li> <li>Add docstrings to new functions</li> <li> <p>Update DEPLOYMENT.md for deployment changes</p> </li> <li> <p>Create Pull Request:</p> </li> <li>Provide clear description of changes</li> <li>Link related issues</li> <li>Add screenshots for UI changes</li> <li> <p>List any breaking changes</p> </li> <li> <p>Code Review:</p> </li> <li>Address review comments</li> <li>Keep discussion focused and professional</li> <li>Be patient - maintainers are volunteers</li> </ol>"},{"location":"contributing/#reporting-bugs","title":"\ud83d\udc1b Reporting Bugs","text":"<p>When reporting bugs, include:</p> <ol> <li>Description: Clear description of the issue</li> <li>Steps to Reproduce: Minimal steps to recreate</li> <li>Expected vs Actual: What should happen vs what happens</li> <li>Environment:</li> <li>OS (Windows/Linux/macOS)</li> <li>Docker version</li> <li>Python version (if relevant)</li> <li>Logs: Relevant error messages or logs    <pre><code>docker compose logs mcp --tail 50\n</code></pre></li> </ol>"},{"location":"contributing/#suggesting-features","title":"\ud83d\udca1 Suggesting Features","text":"<p>For feature requests:</p> <ol> <li>Use Case: Describe the problem you're solving</li> <li>Proposed Solution: Your suggested approach</li> <li>Alternatives: Other solutions you considered</li> <li>Examples: Similar features in other projects</li> </ol>"},{"location":"contributing/#development-tips","title":"\ud83d\udd0d Development Tips","text":""},{"location":"contributing/#debugging-mcp-server","title":"Debugging MCP Server","text":"<pre><code># View MCP server logs in real-time\ndocker compose logs mcp -f\n\n# Check MCP server is responding\ncurl http://localhost:8080/sse\n\n# Test MCP tools directly\ndocker compose run --rm pytest python -c \"from tools.personalDataTool import fetch_person_data; print(fetch_person_data.invoke({'name': 'Test'}))\"\n</code></pre>"},{"location":"contributing/#debugging-neo4j","title":"Debugging Neo4j","text":"<pre><code># Access Neo4j shell\ndocker exec -it personamate-neo4j cypher-shell -u neo4j -p personamate\n\n# View all data\nMATCH (n) RETURN n LIMIT 25;\n\n# Clear test data\nMATCH (n) WHERE n.name STARTS WITH 'Test' DETACH DELETE n;\n</code></pre>"},{"location":"contributing/#quick-iterations","title":"Quick Iterations","text":"<pre><code># Rebuild just MCP server\ndocker compose build mcp\n\n# Restart without rebuilding\ndocker compose restart mcp\n\n# Full reset\ndocker compose down -v &amp;&amp; ./deploy.sh mcp-only\n</code></pre>"},{"location":"contributing/#resources","title":"\ud83d\udcda Resources","text":"<ul> <li>FastMCP Documentation: https://gofastmcp.com</li> <li>Neo4j Documentation: https://neo4j.com/docs</li> <li>Black Documentation: https://black.readthedocs.io</li> <li>MCP Protocol: https://modelcontextprotocol.io</li> </ul>"},{"location":"contributing/#getting-help","title":"\ud83d\udce7 Getting Help","text":"<ul> <li>GitHub Issues: For bugs and feature requests</li> <li>GitHub Discussions: For questions and ideas</li> <li>Pull Request Comments: For code review questions</li> </ul>"},{"location":"contributing/#code-of-conduct","title":"\ud83d\udcdc Code of Conduct","text":"<ul> <li>Be respectful and inclusive</li> <li>Welcome newcomers</li> <li>Focus on constructive feedback</li> <li>Assume good intentions</li> </ul> <p>Thank you for contributing to PersonaMate! \ud83c\udf89</p>"},{"location":"deployment/","title":"PersonaMate Deployment Guide","text":""},{"location":"deployment/#deployment-options","title":"Deployment Options","text":"<p>PersonaMate offers two deployment modes to suit different use cases:</p>"},{"location":"deployment/#1-full-stack-deployment","title":"1. Full Stack Deployment","text":"<p>Best for: End users who want a complete AI chat experience</p> <p>Includes: - MCP Server (FastMCP) - AI integration layer - Neo4j Database - Knowledge graph storage - OpenWebUI - Web-based chat interface</p> <p>Access: - Chat Interface: http://localhost:3000 - MCP Server: http://localhost:8080/sse - Neo4j Browser: http://localhost:7474</p>"},{"location":"deployment/#2-mcp-only-deployment","title":"2. MCP-Only Deployment","text":"<p>Best for: Developers integrating PersonaMate into custom applications</p> <p>Includes: - MCP Server (FastMCP) - AI integration layer - Neo4j Database - Knowledge graph storage</p> <p>Access: - MCP Server: http://localhost:8080/sse - Neo4j Browser: http://localhost:7474</p>"},{"location":"deployment/#using-the-deployment-scripts","title":"Using the Deployment Scripts","text":""},{"location":"deployment/#windows-powershell","title":"Windows (PowerShell)","text":"<ol> <li> <p>Interactive mode (recommended for first-time users):    <pre><code>.\\deploy.ps1\n</code></pre>    Follow the on-screen prompts to choose your deployment mode.</p> </li> <li> <p>Direct deployment:    <pre><code># Full stack with OpenWebUI\n.\\deploy.ps1 -Mode full\n\n# MCP-only deployment\n.\\deploy.ps1 -Mode mcp-only\n</code></pre></p> </li> </ol>"},{"location":"deployment/#linuxmacos","title":"Linux/macOS","text":"<ol> <li> <p>Make script executable (first time only):    <pre><code>chmod +x deploy.sh\n</code></pre></p> </li> <li> <p>Interactive mode (recommended for first-time users):    <pre><code>./deploy.sh\n</code></pre>    Follow the on-screen prompts to choose your deployment mode.</p> </li> <li> <p>Direct deployment:    <pre><code># Full stack with OpenWebUI\n./deploy.sh full\n\n# MCP-only deployment\n./deploy.sh mcp-only\n</code></pre></p> </li> </ol>"},{"location":"deployment/#what-the-script-does","title":"What the Script Does","text":"<ol> <li>Checks prerequisites: Verifies Docker and Docker Compose are installed</li> <li>Validates environment: Checks for .env file and Docker daemon status</li> <li>Builds images: Compiles the MCP server Docker image</li> <li>Starts services: Launches selected services based on deployment mode</li> <li>Health checks: Waits for services to be ready</li> <li>Displays access info: Shows URLs and credentials</li> </ol>"},{"location":"deployment/#environment-configuration","title":"Environment Configuration","text":"<p>Before deploying, ensure your <code>.env</code> file is configured:</p> <pre><code># Required\nOPENAI_API_KEY=your_openai_api_key_here\n\n# Neo4j Configuration\nNEO4J_URI=bolt://neo4j:7687\nNEO4J_USER=neo4j\nNEO4J_PASSWORD=personamate\nNEO4J_DB=neo4j\n\n# Optional: LangChain Tracing\nLANGCHAIN_API_KEY=your_langchain_key\nLANGCHAIN_TRACING_V2=false\n</code></pre>"},{"location":"deployment/#post-deployment-steps","title":"Post-Deployment Steps","text":""},{"location":"deployment/#for-full-stack-deployment","title":"For Full Stack Deployment","text":"<ol> <li>Access OpenWebUI: Navigate to http://localhost:3000</li> <li>Create Admin Account: First-time setup requires creating an admin user</li> <li>Configure MCP Connection:</li> <li>Go to Settings \u2192 Connections</li> <li>Add MCP Server URL: <code>http://mcp:8080/sse</code></li> <li>Test connection</li> <li>Start Chatting: Begin interacting with PersonaMate!</li> </ol>"},{"location":"deployment/#for-mcp-only-deployment","title":"For MCP-Only Deployment","text":"<ol> <li>Connect Your MCP Client: Configure your client to connect to <code>http://localhost:8080/sse</code></li> <li>Test Connection: Use MCP protocol tools to list available tools/resources</li> <li>Integrate: Use PersonaMate tools in your application</li> </ol>"},{"location":"deployment/#managing-services","title":"Managing Services","text":""},{"location":"deployment/#view-service-status","title":"View Service Status","text":"<pre><code>docker compose ps\n</code></pre>"},{"location":"deployment/#view-logs","title":"View Logs","text":"<pre><code># All services\ndocker compose logs -f\n\n# Specific service\ndocker compose logs -f mcp\ndocker compose logs -f neo4j\ndocker compose logs -f openwebui\n</code></pre>"},{"location":"deployment/#restart-services","title":"Restart Services","text":"<pre><code># All services\ndocker compose restart\n\n# Specific service\ndocker compose restart mcp\n</code></pre>"},{"location":"deployment/#stop-services","title":"Stop Services","text":"<pre><code>docker compose down\n</code></pre>"},{"location":"deployment/#stop-and-remove-data","title":"Stop and Remove Data","text":"<pre><code>docker compose down -v\n</code></pre>"},{"location":"deployment/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/#services-wont-start","title":"Services Won't Start","text":"<p>Check Docker daemon: <pre><code>docker ps\n</code></pre></p> <p>View service logs: <pre><code>docker compose logs mcp --tail 50\ndocker compose logs neo4j --tail 50\n</code></pre></p>"},{"location":"deployment/#neo4j-connection-issues","title":"Neo4j Connection Issues","text":"<ol> <li>Wait 15-20 seconds after starting Neo4j</li> <li>Check Neo4j logs: <code>docker compose logs neo4j</code></li> <li>Verify credentials in <code>.env</code> file</li> <li>Test connection: http://localhost:7474</li> </ol>"},{"location":"deployment/#mcp-server-not-responding","title":"MCP Server Not Responding","text":"<ol> <li>Check if service is running: <code>docker compose ps</code></li> <li>View MCP logs: <code>docker compose logs mcp -f</code></li> <li>Verify environment variables are set</li> <li>Restart MCP service: <code>docker compose restart mcp</code></li> </ol>"},{"location":"deployment/#openwebui-cant-connect-to-mcp","title":"OpenWebUI Can't Connect to MCP","text":"<ol> <li>Ensure both services are running</li> <li>Use internal Docker network name: <code>http://mcp:8080/sse</code> (not <code>localhost</code>)</li> <li>Check firewall settings</li> <li>Verify MCP server is in SSE mode (check logs)</li> </ol>"},{"location":"deployment/#advanced-configuration","title":"Advanced Configuration","text":""},{"location":"deployment/#custom-ports","title":"Custom Ports","text":"<p>Edit <code>docker-compose.yml</code> to change default ports:</p> <pre><code>services:\n  mcp:\n    ports:\n      - \"8080:8080\"  # Change first number for custom external port\n\n  neo4j:\n    ports:\n      - \"7474:7474\"  # HTTP\n      - \"7687:7687\"  # Bolt\n\n  openwebui:\n    ports:\n      - \"3000:8080\"  # Change first number for custom external port\n</code></pre>"},{"location":"deployment/#resource-limits","title":"Resource Limits","text":"<p>Adjust memory/CPU limits in <code>docker-compose.yml</code>:</p> <pre><code>services:\n  neo4j:\n    deploy:\n      resources:\n        limits:\n          memory: 2G\n          cpus: '2'\n</code></pre>"},{"location":"deployment/#persistent-data","title":"Persistent Data","text":"<p>Neo4j data is persisted in Docker volumes. To backup:</p> <pre><code># List volumes\ndocker volume ls\n\n# Backup Neo4j data\ndocker run --rm -v personamate_neo4j_data:/data -v $(pwd):/backup alpine tar czf /backup/neo4j-backup.tar.gz /data\n</code></pre>"},{"location":"deployment/#security-considerations","title":"Security Considerations","text":""},{"location":"deployment/#production-deployment","title":"Production Deployment","text":"<ol> <li>Change default passwords: Update Neo4j password in <code>.env</code></li> <li>Use HTTPS: Configure reverse proxy (nginx/traefik)</li> <li>API key security: Never commit <code>.env</code> file to version control</li> <li>Network isolation: Use Docker networks to isolate services</li> <li>Resource limits: Set appropriate memory/CPU limits</li> <li>Regular backups: Backup Neo4j data regularly</li> </ol>"},{"location":"deployment/#openwebui-security","title":"OpenWebUI Security","text":"<ul> <li>Enable authentication</li> <li>Use strong passwords</li> <li>Configure CORS properly</li> <li>Use HTTPS in production</li> <li>Keep OpenWebUI updated</li> </ul>"},{"location":"deployment/#getting-help","title":"Getting Help","text":"<ul> <li>Documentation: See README.md for detailed documentation</li> <li>Issues: Report bugs on GitHub Issues</li> <li>Logs: Always check service logs first for troubleshooting</li> <li>Community: Join discussions on GitHub Discussions</li> </ul>"},{"location":"docker/","title":"Docker Setup","text":"<p>This repository has been updated to use a separate backend service (FastAPI) and an OpenWebUI frontend, orchestrated with Docker Compose.</p> <p>What was added - <code>Dockerfile</code> - builds the backend image and runs the FastAPI app on port 8000. - <code>docker-compose.yml</code> - brings up two services: <code>backend</code> and <code>openwebui</code>. - <code>.dockerignore</code> - keeps Docker context small.</p> <p>Notes and assumptions - The backend is the original PersonaMate logic exposed as a JSON API at <code>/chat</code>. - The OpenWebUI image name in <code>docker-compose.yml</code> is set to <code>ghcr.io/openwebui/open-webui:main</code>.   Please adjust this to the correct image or tag if your environment uses a different registry or image name. - OpenWebUI configuration varies between builds. You may need to configure OpenWebUI to call the backend API   (for example, by setting an API endpoint in OpenWebUI's settings or by placing a simple proxy in front of both services).</p> <p>Quick start (Docker Desktop / Docker Compose installed)</p> <ol> <li>Build and run services:</li> </ol> <pre><code>docker compose up --build\n</code></pre> <ol> <li> <p>Backend will be exposed on http://localhost:8000</p> </li> <li> <p>OpenWebUI (frontend) will be exposed on http://localhost:3000 (depending on the image/config)</p> </li> </ol> <p>If OpenWebUI doesn't automatically call the backend, either configure it in OpenWebUI's UI or use a HTTP proxy to forward certain paths from the UI to <code>http://backend:8000</code> in the compose network.</p> <p>Environment variables and <code>.env</code> - The Compose file now supports reading environment variables from a <code>.env</code> file via the <code>env_file</code> setting on services. Put your API keys and other secrets in a top-level <code>.env</code> file (next to <code>docker-compose.yml</code>) and they will be available inside the containers.</p> <p>Example <code>.env</code> contents:</p> <pre><code>OPENAI_API_KEY=your_openai_key\n</code></pre> <p>Be careful not to commit <code>.env</code> to version control. Add <code>.env</code> to your <code>.gitignore</code> if needed.</p> <p>Next steps - Verify OpenWebUI image name and its expected configuration options and update <code>docker-compose.yml</code> if necessary. - Optionally add a reverse proxy (NGINX) service to route UI and API under the same domain.</p>"},{"location":"mcp/","title":"PersonaMate MCP Documentation","text":"<p>PersonaMate implements the Model Context Protocol (MCP) using FastMCP, providing a standardized interface for AI assistants to interact with your personal knowledge graph.</p>"},{"location":"mcp/#overview","title":"Overview","text":"<p>The MCP server (<code>src/python/mcp_server.py</code>) exposes: - Tools: Callable functions for managing persons and relationships - Resources: Read-only access to graph data - Prompts: Reusable templates for common queries</p>"},{"location":"mcp/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  MCP Client     \u2502  (Claude Desktop, IDEs, custom clients)\n\u2502  (stdio/SSE)    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502 MCP Protocol\n         \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  FastMCP Server \u2502  (src/python/mcp_server.py)\n\u2502  Port 8080      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2502 Neo4j Driver\n         \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Neo4j DB     \u2502  (Knowledge Graph)\n\u2502  Port 7687      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"mcp/#connection-methods","title":"Connection Methods","text":""},{"location":"mcp/#1-stdio-transport-recommended-for-claude-desktop","title":"1. Stdio Transport (recommended for Claude Desktop)","text":"<pre><code>{\n  \"mcpServers\": {\n    \"personamate\": {\n      \"command\": \"python\",\n      \"args\": [\"/path/to/PersonaMate/src/python/mcp_server.py\"],\n      \"env\": {\n        \"NEO4J_URI\": \"bolt://localhost:7687\",\n        \"NEO4J_USER\": \"neo4j\",\n        \"NEO4J_PASSWORD\": \"your-password\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"mcp/#2-sse-transport-for-http-clients","title":"2. SSE Transport (for HTTP clients)","text":"<p>Start the server: <pre><code>python src/python/mcp_server.py --transport sse --port 8080\n</code></pre></p> <p>Connect via: <code>http://localhost:8080/sse</code></p>"},{"location":"mcp/#tools","title":"Tools","text":""},{"location":"mcp/#fetch_person","title":"fetch_person","text":"<p>Look up information about a person from the knowledge graph.</p> <p>Parameters: - <code>name</code> (string, required): The name of the person to look up</p> <p>Returns: JSON string containing person data and related graph context</p> <p>Example: <pre><code>result = await session.call_tool(\"fetch_person\", {\"name\": \"Alice Smith\"})\n</code></pre></p>"},{"location":"mcp/#update_person","title":"update_person","text":"<p>Update a person's information in the knowledge graph.</p> <p>Parameters: - <code>name</code> (string, required): The name of the person - <code>field</code> (string, required): The field to update (e.g., 'age', 'email', 'location') - <code>value</code> (string, required): The new value</p> <p>Returns: Success message</p> <p>Example: <pre><code>result = await session.call_tool(\"update_person\", {\n    \"name\": \"Alice Smith\",\n    \"field\": \"age\",\n    \"value\": \"30\"\n})\n</code></pre></p>"},{"location":"mcp/#link_entities","title":"link_entities","text":"<p>Create a relationship between two entities in the knowledge graph.</p> <p>Parameters: - <code>element1</code> (string, required): Name of the first entity - <code>type1</code> (string, required): Type of first entity (e.g., 'Person', 'Organization') - <code>element2</code> (string, required): Name of the second entity - <code>type2</code> (string, required): Type of second entity - <code>linktype</code> (string, required): Relationship type (e.g., 'knows', 'likes', 'works_at')</p> <p>Returns: Success message</p> <p>Example: <pre><code>result = await session.call_tool(\"link_entities\", {\n    \"element1\": \"Alice Smith\",\n    \"type1\": \"Person\",\n    \"element2\": \"Bob Johnson\",\n    \"type2\": \"Person\",\n    \"linktype\": \"knows\"\n})\n</code></pre></p>"},{"location":"mcp/#get_entity_context","title":"get_entity_context","text":"<p>Get rich context about an entity including its relationships.</p> <p>Parameters: - <code>name</code> (string, required): Name of the entity - <code>entity_type</code> (string, optional): Type of entity (default: 'Person') - <code>depth</code> (integer, optional): How many hops to traverse (default: 1)</p> <p>Returns: JSON string with nodes, edges, and human-readable summary</p> <p>Example: <pre><code>result = await session.call_tool(\"get_entity_context\", {\n    \"name\": \"Alice Smith\",\n    \"entity_type\": \"Person\",\n    \"depth\": 2\n})\n</code></pre></p>"},{"location":"mcp/#resources","title":"Resources","text":"<p>Resources provide read-only access to graph data.</p>"},{"location":"mcp/#graphpersons","title":"graph://persons","text":"<p>List all persons in the knowledge graph.</p> <p>Returns: Newline-separated list of person names</p>"},{"location":"mcp/#graphrelationships","title":"graph://relationships","text":"<p>List all relationships in the knowledge graph (up to 100).</p> <p>Returns: Formatted list of relationships in the format: <pre><code>Name1 (Type1) -[RELATIONSHIP]-&gt; Name2 (Type2)\n</code></pre></p>"},{"location":"mcp/#graphstats","title":"graph://stats","text":"<p>Get statistics about the knowledge graph.</p> <p>Returns: Node counts by label and relationship counts by type</p>"},{"location":"mcp/#prompts","title":"Prompts","text":""},{"location":"mcp/#person_lookup_prompt","title":"person_lookup_prompt","text":"<p>Generate a comprehensive information lookup prompt for a person.</p> <p>Parameters: - <code>name</code> (string): Name of the person</p>"},{"location":"mcp/#relationship_analysis_prompt","title":"relationship_analysis_prompt","text":"<p>Generate a prompt for analyzing relationships between two people.</p> <p>Parameters: - <code>person1</code> (string): First person's name - <code>person2</code> (string): Second person's name</p>"},{"location":"mcp/#error-handling","title":"Error Handling","text":"<p>The MCP server handles errors gracefully: - Invalid tool parameters return descriptive error messages - Neo4j connection errors are logged and returned to the client - All resources include error handling for database failures</p>"},{"location":"mcp/#example-client-usage","title":"Example Client Usage","text":"<pre><code>from mcp import ClientSession, StdioServerParameters\nfrom mcp.client.stdio import stdio_client\n\nserver_params = StdioServerParameters(\n    command=\"python\",\n    args=[\"src/python/mcp_server.py\"]\n)\n\nasync with stdio_client(server_params) as (read, write):\n    async with ClientSession(read, write) as session:\n        await session.initialize()\n\n        # Call a tool\n        result = await session.call_tool(\"fetch_person\", {\"name\": \"Alice\"})\n        print(result.content[0].text)\n\n        # Read a resource\n        result = await session.read_resource(\"graph://stats\")\n        print(result.contents[0].text)\n</code></pre>"},{"location":"mcp/#implementation-details","title":"Implementation Details","text":"<p>The MCP server is built using FastMCP, which provides: - Automatic tool schema generation from type hints - Built-in support for stdio and SSE transports - Decorator-based API for defining tools, resources, and prompts - Full MCP protocol compliance</p> <p>Key files: - <code>src/python/mcp_server.py</code>: Main MCP server implementation - <code>src/python/tools/personalDataTool.py</code>: Person management tools - <code>src/python/tools/linkingTool.py</code>: Relationship management tools - <code>src/python/utils/neo4j_graph.py</code>: Neo4j database wrapper</p>"},{"location":"mcp/#security-considerations","title":"Security Considerations","text":"<ul> <li>Neo4j Credentials: Store in environment variables, never commit to git</li> <li>Network Access: MCP server runs locally by default</li> <li>Input Validation: All tool parameters are validated by FastMCP</li> <li>Resource Limits: Relationship listings are limited to 100 entries</li> </ul>"},{"location":"mcp/#future-enhancements","title":"Future Enhancements","text":"<p>Planned improvements: - [ ] Add authentication for SSE transport - [ ] Implement pagination for large result sets - [ ] Add more entity types (Organizations, Projects, etc.) - [ ] Support for file attachments and documents - [ ] Advanced graph query tools (path finding, clustering)</p>"},{"location":"mcp/#support","title":"Support","text":"<p>For issues or questions: - Review Neo4j logs if database connection fails - Ensure all environment variables are set correctly</p>"},{"location":"quickstart/","title":"Quick Deployment Reference","text":""},{"location":"quickstart/#tldr-get-started-in-2-commands","title":"TL;DR - Get Started in 2 Commands","text":""},{"location":"quickstart/#windows","title":"Windows","text":"<pre><code># Run as Administrator if execution policy is restricted\nSet-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser\n.\\deploy.ps1\n</code></pre>"},{"location":"quickstart/#linuxmacos","title":"Linux/macOS","text":"<pre><code>chmod +x deploy.sh &amp;&amp; ./deploy.sh\n</code></pre>"},{"location":"quickstart/#deployment-modes","title":"Deployment Modes","text":"Mode Services Best For Access Full Stack MCP + Neo4j + OpenWebUI End users wanting chat interface http://localhost:3000 MCP Only MCP + Neo4j Developers, custom integrations http://localhost:8080/sse"},{"location":"quickstart/#quick-commands","title":"Quick Commands","text":""},{"location":"quickstart/#deploy","title":"Deploy","text":"<pre><code># Interactive (choose during deployment)\n./deploy.sh              # Linux/macOS\n.\\deploy.ps1             # Windows\n\n# Direct\n./deploy.sh full         # Full stack\n./deploy.sh mcp-only     # MCP only\n</code></pre>"},{"location":"quickstart/#manage","title":"Manage","text":"<pre><code>docker compose ps                    # View status\ndocker compose logs -f               # View all logs\ndocker compose logs -f mcp           # View MCP logs\ndocker compose restart mcp           # Restart MCP\ndocker compose down                  # Stop all\ndocker compose down -v               # Stop and remove data\n</code></pre>"},{"location":"quickstart/#access-urls","title":"Access URLs","text":"Service URL Default Credentials OpenWebUI http://localhost:3000 Create on first visit MCP Server http://localhost:8080/sse No auth Neo4j Browser http://localhost:7474 neo4j / personamate"},{"location":"quickstart/#common-issues","title":"Common Issues","text":""},{"location":"quickstart/#docker-daemon-not-running","title":"\"Docker daemon not running\"","text":"<p>\u2192 Start Docker Desktop</p>"},{"location":"quickstart/#permission-denied-linuxmacos","title":"\"Permission denied\" (Linux/macOS)","text":"<p>\u2192 Run: <code>chmod +x deploy.sh</code></p>"},{"location":"quickstart/#execution-policy-restricted-windows","title":"\"Execution policy restricted\" (Windows)","text":"<p>\u2192 Run as Admin: <code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</code></p>"},{"location":"quickstart/#neo4j-connection-fails","title":"Neo4j connection fails","text":"<p>\u2192 Wait 15-20 seconds after deployment, Neo4j needs time to initialize</p>"},{"location":"quickstart/#openwebui-cant-connect-to-mcp","title":"OpenWebUI can't connect to MCP","text":"<p>\u2192 Use <code>http://mcp:8080/sse</code> not <code>http://localhost:8080/sse</code> in OpenWebUI settings</p>"},{"location":"quickstart/#need-more-help","title":"Need More Help?","text":"<ul> <li>Full guide: <code>DEPLOYMENT.md</code></li> <li>Documentation: <code>README.md</code></li> <li>CI/CD info: <code>.github/workflows/README.md</code></li> </ul>"},{"location":"structure/","title":"Project Structure","text":"<p>This page documents the organization of the PersonaMate codebase.</p>"},{"location":"structure/#directory-layout","title":"Directory Layout","text":"<pre><code>PersonaMate/\n\u251c\u2500\u2500 .github/\n\u2502   \u2514\u2500\u2500 workflows/\n\u2502       \u251c\u2500\u2500 ci.yml              # GitHub Actions CI/CD pipeline\n\u2502       \u2514\u2500\u2500 README.md           # CI/CD documentation\n\u251c\u2500\u2500 docs/                       # Documentation (MkDocs)\n\u2502   \u251c\u2500\u2500 index.md               # Home page\n\u2502   \u251c\u2500\u2500 quickstart.md          # Quick start guide\n\u2502   \u251c\u2500\u2500 deployment.md          # Deployment guide\n\u2502   \u251c\u2500\u2500 docker.md              # Docker documentation\n\u2502   \u251c\u2500\u2500 contributing.md        # Contribution guidelines\n\u2502   \u251c\u2500\u2500 workflows.md           # CI/CD pipeline docs\n\u2502   \u251c\u2500\u2500 testing.md             # Testing guide\n\u2502   \u251c\u2500\u2500 structure.md           # This file\n\u2502   \u251c\u2500\u2500 mcp.md                 # MCP protocol docs\n\u2502   \u2514\u2500\u2500 api/                   # API reference\n\u2502       \u251c\u2500\u2500 tools.md           # MCP tools\n\u2502       \u2514\u2500\u2500 resources.md       # MCP resources\n\u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 python/\n\u2502   \u2502   \u251c\u2500\u2500 mcp_server.py      # FastMCP server (main entry point)\n\u2502   \u2502   \u251c\u2500\u2500 fastmcp.json       # FastMCP configuration\n\u2502   \u2502   \u251c\u2500\u2500 tools/             # MCP tool implementations\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 personalDataTool.py  # Person CRUD operations\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 linkingTool.py       # Relationship management\n\u2502   \u2502   \u2514\u2500\u2500 utils/             # Shared utilities\n\u2502   \u2502       \u251c\u2500\u2500 neo4j_graph.py       # Neo4j wrapper\n\u2502   \u2502       \u251c\u2500\u2500 helper.py            # Utility functions\n\u2502   \u2502       \u2514\u2500\u2500 MultiPurposeGraph.py # Graph abstraction\n\u2502   \u2514\u2500\u2500 templates/\n\u2502       \u2514\u2500\u2500 index.html         # Web templates (if needed)\n\u251c\u2500\u2500 test/\n\u2502   \u2514\u2500\u2500 python/\n\u2502       \u251c\u2500\u2500 test_mcp_integration.py  # MCP protocol tests (6 tests)\n\u2502       \u251c\u2500\u2500 test_tools.py            # Tool implementation tests (14 tests)\n\u2502       \u2514\u2500\u2500 utils/\n\u2502           \u2514\u2500\u2500 MultiPurposeGraph_test.py  # Graph utility tests\n\u251c\u2500\u2500 deploy.ps1                 # Windows PowerShell deployment script\n\u251c\u2500\u2500 deploy.sh                  # Linux/macOS Bash deployment script\n\u251c\u2500\u2500 docker-compose.yml         # Docker services orchestration\n\u251c\u2500\u2500 Dockerfile                 # MCP server container image\n\u251c\u2500\u2500 mkdocs.yml                 # Documentation site configuration\n\u251c\u2500\u2500 .pre-commit-config.yaml    # Pre-commit hooks configuration\n\u251c\u2500\u2500 requirements.txt           # Python dependencies\n\u251c\u2500\u2500 create_data.sh            # Sample data creation script\n\u251c\u2500\u2500 LICENSE                    # Project license\n\u2514\u2500\u2500 README.md                  # Main project README\n</code></pre>"},{"location":"structure/#core-components","title":"Core Components","text":""},{"location":"structure/#mcp-server-srcpythonmcp_serverpy","title":"MCP Server (<code>src/python/mcp_server.py</code>)","text":"<p>The main entry point for PersonaMate. Built with FastMCP framework.</p> <p>Key responsibilities: - Initialize MCP server with SSE transport - Register tools and resources - Handle MCP protocol communication - Manage Neo4j connection lifecycle</p> <p>Key code: <pre><code>from fastmcp import FastMCP\n\nmcp = FastMCP(\"personamate\")\n\n@mcp.tool()\nasync def fetch_person(name: str) -&gt; str:\n    \"\"\"Fetch person data from graph\"\"\"\n    # Implementation\n</code></pre></p> <p>Dependencies: - FastMCP SDK (MCP protocol implementation) - Neo4j driver (graph database) - Tool implementations</p>"},{"location":"structure/#tools-directory-srcpythontools","title":"Tools Directory (<code>src/python/tools/</code>)","text":"<p>Modular tool implementations for PersonaMate functionality.</p>"},{"location":"structure/#personal-data-tool-personaldatatoolpy","title":"Personal Data Tool (<code>personalDataTool.py</code>)","text":"<p>Manages person entities in the knowledge graph.</p> <p>Functions: - <code>fetch_person(name: str)</code> - Retrieve person information - <code>update_person(name: str, **kwargs)</code> - Create or update person</p> <p>Key features: - Case-insensitive name matching - JSON storage for nested objects (addresses) - Neo4j transaction management - Error handling for missing persons</p> <p>Database schema: <pre><code>(:Person {\n    name: string,\n    age: integer,\n    email: string,\n    phone: string,\n    address: string  // JSON serialized\n})\n</code></pre></p>"},{"location":"structure/#linking-tool-linkingtoolpy","title":"Linking Tool (<code>linkingTool.py</code>)","text":"<p>Manages relationships between entities in the graph.</p> <p>Functions: - <code>link_entities(from_entity: str, to_entity: str, relationship_type: str)</code> - Create relationship - <code>get_entity_context(entity_name: str)</code> - Get entity's relationship context</p> <p>Key features: - Dynamic relationship types - Bidirectional relationship queries - Rich context with properties - Multi-hop traversal</p> <p>Database schema: <pre><code>(:Person)-[r:RELATIONSHIP_TYPE {\n    created_at: datetime,\n    properties: map\n}]-&gt;(:Person)\n</code></pre></p>"},{"location":"structure/#utilities-directory-srcpythonutils","title":"Utilities Directory (<code>src/python/utils/</code>)","text":"<p>Shared utility functions and abstractions.</p>"},{"location":"structure/#neo4j-graph-neo4j_graphpy","title":"Neo4j Graph (<code>neo4j_graph.py</code>)","text":"<p>Neo4j database connection and query wrapper.</p> <p>Key responsibilities: - Connection management - Query execution - Transaction handling - Error handling</p>"},{"location":"structure/#helper-functions-helperpy","title":"Helper Functions (<code>helper.py</code>)","text":"<p>Common utility functions used across the codebase.</p> <p>Functions: - String manipulation - Data validation - Format conversion - Logging utilities</p>"},{"location":"structure/#multipurpose-graph-multipurposegraphpy","title":"MultiPurpose Graph (<code>MultiPurposeGraph.py</code>)","text":"<p>Graph abstraction layer for flexible graph operations.</p> <p>Features: - Abstract graph interface - Multiple backend support - Query optimization - Caching layer</p>"},{"location":"structure/#test-structure","title":"Test Structure","text":""},{"location":"structure/#mcp-integration-tests-testpythontest_mcp_integrationpy","title":"MCP Integration Tests (<code>test/python/test_mcp_integration.py</code>)","text":"<p>Tests MCP protocol compliance and server functionality.</p> <p>Test coverage: - Server initialization - Tool listing - Resource listing - Tool invocation - Resource reading - Prompt listing</p> <p>Dependencies: - MCP server must be running - Neo4j database connection - MCP SDK client</p>"},{"location":"structure/#tool-implementation-tests-testpythontest_toolspy","title":"Tool Implementation Tests (<code>test/python/test_tools.py</code>)","text":"<p>Tests tool functionality and business logic.</p> <p>Test coverage: - Person CRUD operations - Relationship creation - Context retrieval - Edge cases and errors - Cross-tool workflows</p> <p>Dependencies: - Neo4j database connection - Tool implementations - Test fixtures</p>"},{"location":"structure/#configuration-files","title":"Configuration Files","text":""},{"location":"structure/#docker-compose-docker-composeyml","title":"Docker Compose (<code>docker-compose.yml</code>)","text":"<p>Orchestrates all services for PersonaMate.</p> <p>Services: - <code>neo4j</code> - Graph database - <code>mcp</code> - MCP server (PersonaMate) - <code>openwebui</code> - Chat interface (optional) - <code>pytest</code> - Test runner</p> <p>Networks: - <code>personamate-network</code> - Internal service communication</p> <p>Volumes: - <code>neo4j_data</code> - Persistent graph data - <code>openwebui_data</code> - OpenWebUI state</p>"},{"location":"structure/#dockerfile","title":"Dockerfile","text":"<p>Container image for MCP server.</p> <p>Base image: Python 3.10 Key layers: - Install Python dependencies - Copy source code - Set environment variables - Expose ports - Run FastMCP server</p>"},{"location":"structure/#mkdocs-configuration-mkdocsyml","title":"MkDocs Configuration (<code>mkdocs.yml</code>)","text":"<p>Documentation website configuration.</p> <p>Theme: Material for MkDocs Features: - Dark/light mode toggle - Search functionality - Code syntax highlighting - Tabbed content - Git revision dates</p> <p>Plugins: - search - git-revision-date-localized</p>"},{"location":"structure/#pre-commit-configuration-pre-commit-configyaml","title":"Pre-commit Configuration (<code>.pre-commit-config.yaml</code>)","text":"<p>Git hooks for code quality.</p> <p>Hooks: - <code>black</code> - Code formatting (120 char) - <code>flake8</code> - Linting - <code>isort</code> - Import sorting - <code>trailing-whitespace</code> - Remove trailing spaces - <code>end-of-file-fixer</code> - Single newline at EOF</p>"},{"location":"structure/#deployment-scripts","title":"Deployment Scripts","text":""},{"location":"structure/#windows-deployment-deployps1","title":"Windows Deployment (<code>deploy.ps1</code>)","text":"<p>PowerShell script for Windows deployment.</p> <p>Features: - Interactive menu - Prerequisites validation - Service health checks - Colored output - Error handling</p> <p>Modes: - Interactive: Menu-driven deployment - Direct: Command-line arguments</p>"},{"location":"structure/#linuxmacos-deployment-deploysh","title":"Linux/macOS Deployment (<code>deploy.sh</code>)","text":"<p>Bash script for Unix-based systems.</p> <p>Features: - Same functionality as PowerShell version - Cross-platform compatibility - POSIX-compliant shell commands - Colored output</p>"},{"location":"structure/#cicd-pipeline","title":"CI/CD Pipeline","text":""},{"location":"structure/#github-actions-githubworkflowsciyml","title":"GitHub Actions (<code>..github/workflows/ci.yml</code>)","text":"<p>Automated testing and deployment pipeline.</p> <p>Jobs: 1. Test Job - Run all tests in Docker 2. Lint Job - Check and auto-format code 3. Build Job - Validate Docker builds (main branch only)</p> <p>Triggers: - Push to <code>main</code> or <code>dev</code> branches - Pull requests to <code>main</code> or <code>dev</code> branches</p> <p>Secrets required: - <code>OPENAI_API_KEY</code> - OpenAI API key - <code>LANGCHAIN_API_KEY</code> - (Optional) LangChain tracing</p>"},{"location":"structure/#data-flow","title":"Data Flow","text":"<pre><code>sequenceDiagram\n    participant Client\n    participant MCP Server\n    participant Tools\n    participant Neo4j\n\n    Client-&gt;&gt;MCP Server: Initialize connection\n    MCP Server--&gt;&gt;Client: Server info + capabilities\n\n    Client-&gt;&gt;MCP Server: List tools\n    MCP Server--&gt;&gt;Client: Available tools\n\n    Client-&gt;&gt;MCP Server: Call tool (fetch_person)\n    MCP Server-&gt;&gt;Tools: Execute fetch_person\n    Tools-&gt;&gt;Neo4j: Query person node\n    Neo4j--&gt;&gt;Tools: Person data\n    Tools--&gt;&gt;MCP Server: Formatted result\n    MCP Server--&gt;&gt;Client: Tool result</code></pre>"},{"location":"structure/#extension-points","title":"Extension Points","text":"<p>PersonaMate is designed to be extensible:</p>"},{"location":"structure/#adding-new-tools","title":"Adding New Tools","text":"<ol> <li>Create tool file in <code>src/python/tools/</code></li> <li>Implement tool function with type hints</li> <li>Register tool in <code>mcp_server.py</code></li> <li>Add tests in <code>test/python/test_tools.py</code></li> <li>Document in <code>docs/api/tools.md</code></li> </ol>"},{"location":"structure/#adding-new-resources","title":"Adding New Resources","text":"<ol> <li>Create resource handler in <code>mcp_server.py</code></li> <li>Register resource with <code>@mcp.resource()</code></li> <li>Add tests in <code>test/python/test_mcp_integration.py</code></li> <li>Document in <code>docs/api/resources.md</code></li> </ol>"},{"location":"structure/#adding-new-graph-operations","title":"Adding New Graph Operations","text":"<ol> <li>Add function to appropriate tool file</li> <li>Update Neo4j queries in <code>utils/neo4j_graph.py</code></li> <li>Add tests</li> <li>Update documentation</li> </ol>"},{"location":"structure/#best-practices","title":"Best Practices","text":""},{"location":"structure/#code-organization","title":"Code Organization","text":"<ul> <li>One tool per file in <code>src/python/tools/</code></li> <li>Shared utilities in <code>src/python/utils/</code></li> <li>Tests mirror source structure</li> <li>Keep tools focused and single-purpose</li> </ul>"},{"location":"structure/#naming-conventions","title":"Naming Conventions","text":"<ul> <li>Snake_case for Python functions</li> <li>PascalCase for Python classes</li> <li>UPPER_CASE for relationship types in Neo4j</li> <li>Descriptive function names (verb_noun pattern)</li> </ul>"},{"location":"structure/#documentation","title":"Documentation","text":"<ul> <li>Docstrings for all public functions</li> <li>Type hints for all parameters</li> <li>Examples in docstrings</li> <li>Keep README.md updated</li> </ul>"},{"location":"structure/#testing","title":"Testing","text":"<ul> <li>Test file per source file</li> <li>Test class per source class</li> <li>Descriptive test names</li> <li>One assertion per test concept</li> </ul>"},{"location":"structure/#next-steps","title":"Next Steps","text":"<ul> <li>MCP Tools \u2192 Explore available tools</li> <li>Testing Guide \u2192 Learn how to test</li> <li>Contributing \u2192 Start contributing</li> </ul>"},{"location":"testing/","title":"Testing Guide","text":"<p>PersonaMate has comprehensive test coverage with automated tests for both MCP protocol integration and tool implementations.</p>"},{"location":"testing/#test-overview","title":"Test Overview","text":"Test Suite Tests Coverage Purpose MCP Integration 6 tests MCP protocol compliance Validates server initialization, tool/resource listing, protocol conformance Tool Implementation 14 tests Tool functionality Tests CRUD operations, relationships, cross-tool workflows Total 20 tests Full coverage End-to-end validation <pre><code>graph TD\n    A[Test Suite] --&gt; B[MCP Integration]\n    A --&gt; C[Tool Implementation]\n    B --&gt; D[Server Init]\n    B --&gt; E[List Tools]\n    B --&gt; F[List Resources]\n    B --&gt; G[Call Tool]\n    B --&gt; H[Read Resource]\n    C --&gt; I[Personal Data]\n    C --&gt; J[Linking]\n    C --&gt; K[Cross-tool]\n    I --&gt; L[CRUD Ops]\n    J --&gt; M[Relationships]\n    K --&gt; N[Workflows]</code></pre>"},{"location":"testing/#running-tests","title":"Running Tests","text":""},{"location":"testing/#quick-test-all-tests","title":"Quick Test (All Tests)","text":"<pre><code># Start services\ndocker compose up -d neo4j mcp\n\n# Run all tests\ndocker compose run --rm pytest pytest /app/test/python/ -v\n</code></pre>"},{"location":"testing/#test-by-suite","title":"Test by Suite","text":"<pre><code># MCP integration tests only (6 tests)\ndocker compose run --rm pytest pytest /app/test/python/test_mcp_integration.py -v\n\n# Tool implementation tests only (14 tests)\ndocker compose run --rm pytest pytest /app/test/python/test_tools.py -v\n</code></pre>"},{"location":"testing/#test-with-coverage","title":"Test with Coverage","text":"<pre><code># Generate coverage report\ndocker compose run --rm pytest pytest /app/test/python/ -v \\\n  --cov=/app/src/python \\\n  --cov-report=term \\\n  --cov-report=html\n\n# View HTML coverage report\n# Open htmlcov/index.html in browser\n</code></pre>"},{"location":"testing/#test-specific-function","title":"Test Specific Function","text":"<pre><code># Test single function\ndocker compose run --rm pytest pytest /app/test/python/test_tools.py::TestPersonalDataTool::test_fetch_person_data_existing -v\n\n# Test class\ndocker compose run --rm pytest pytest /app/test/python/test_tools.py::TestPersonalDataTool -v\n</code></pre>"},{"location":"testing/#test-suites","title":"Test Suites","text":""},{"location":"testing/#mcp-integration-tests","title":"MCP Integration Tests","text":"<p>File: <code>test/python/test_mcp_integration.py</code></p> <p>Tests Model Context Protocol compliance and server functionality.</p>"},{"location":"testing/#test-server-initialization","title":"Test: Server Initialization","text":"<pre><code>@pytest.mark.asyncio\nasync def test_server_initialization():\n    \"\"\"Test that MCP server initializes correctly\"\"\"\n    result = await client.initialize()\n    assert result.protocolVersion == \"2024-11-05\"\n    assert result.serverInfo.name == \"personamate\"\n</code></pre> <p>Validates: - Server starts successfully - Protocol version matches spec - Server name configured correctly</p>"},{"location":"testing/#test-list-tools","title":"Test: List Tools","text":"<pre><code>@pytest.mark.asyncio\nasync def test_list_tools():\n    \"\"\"Test listing available tools\"\"\"\n    result = await client.list_tools()\n    tool_names = [tool.name for tool in result.tools]\n    assert \"fetch_person\" in tool_names\n    assert \"update_person\" in tool_names\n</code></pre> <p>Validates: - All tools exposed via MCP - Tool schemas correct - Tool names match specification</p>"},{"location":"testing/#test-list-resources","title":"Test: List Resources","text":"<pre><code>@pytest.mark.asyncio\nasync def test_list_resources():\n    \"\"\"Test listing available resources\"\"\"\n    result = await client.list_resources()\n    uris = [resource.uri for resource in result.resources]\n    assert \"graph://persons\" in uris\n</code></pre> <p>Validates: - Resources discoverable - Resource URIs correct - Resource descriptions present</p>"},{"location":"testing/#test-call-tool","title":"Test: Call Tool","text":"<pre><code>@pytest.mark.asyncio\nasync def test_call_tool():\n    \"\"\"Test calling a tool via MCP\"\"\"\n    result = await client.call_tool(\"update_person\", {\n        \"name\": \"Alice Johnson\",\n        \"age\": 30\n    })\n    assert result.content[0].type == \"text\"\n</code></pre> <p>Validates: - Tool invocation works - Parameters passed correctly - Results returned in correct format</p>"},{"location":"testing/#test-read-resource","title":"Test: Read Resource","text":"<pre><code>@pytest.mark.asyncio\nasync def test_read_resource():\n    \"\"\"Test reading a resource via MCP\"\"\"\n    result = await client.read_resource(\"graph://persons\")\n    assert len(result.contents) &gt; 0\n</code></pre> <p>Validates: - Resource reading works - Content returned correctly - Resource format valid</p>"},{"location":"testing/#test-list-prompts","title":"Test: List Prompts","text":"<pre><code>@pytest.mark.asyncio\nasync def test_list_prompts():\n    \"\"\"Test listing available prompts\"\"\"\n    result = await client.list_prompts()\n    prompt_names = [prompt.name for prompt in result.prompts]\n    assert \"person_lookup_prompt\" in prompt_names\n</code></pre> <p>Validates: - Prompts exposed - Prompt metadata correct - Arguments defined properly</p> <p>Prerequisites: - MCP server must be running: <code>docker compose up -d mcp</code> - Neo4j must be running: <code>docker compose up -d neo4j</code></p>"},{"location":"testing/#tool-implementation-tests","title":"Tool Implementation Tests","text":"<p>File: <code>test/python/test_tools.py</code></p> <p>Tests actual functionality of PersonaMate tools.</p>"},{"location":"testing/#personal-data-tool-tests-7-tests","title":"Personal Data Tool Tests (7 tests)","text":"<p>Test: Create Person <pre><code>@pytest.mark.asyncio\nasync def test_update_person_data_new_person(self):\n    \"\"\"Test creating a new person in the graph\"\"\"\n    result = await update_person(\n        name=\"John Doe\",\n        age=30,\n        email=\"john@example.com\",\n        phone=\"123-456-7890\",\n        address={\"street\": \"123 Main St\", \"city\": \"Boston\"}\n    )\n    assert \"John Doe\" in result\n</code></pre></p> <p>Validates: - Person creation - Property storage - Nested address object (JSON)</p> <p>Test: Fetch Person <pre><code>@pytest.mark.asyncio\nasync def test_fetch_person_data_existing(self):\n    \"\"\"Test fetching an existing person\"\"\"\n    result = await fetch_person(name=\"John Doe\")\n    assert \"John Doe\" in result\n    assert \"123 Main St\" in result\n</code></pre></p> <p>Validates: - Person lookup - Property retrieval - JSON deserialization</p> <p>Test: Update Person <pre><code>@pytest.mark.asyncio\nasync def test_update_person_data_update_existing(self):\n    \"\"\"Test updating an existing person\"\"\"\n    result = await update_person(name=\"John Doe\", age=31)\n    assert \"updated\" in result.lower() or \"created\" in result.lower()\n</code></pre></p> <p>Validates: - Person updates - Partial updates (only specified fields) - Idempotency</p> <p>Test: Case-Insensitive Matching <pre><code>@pytest.mark.asyncio\nasync def test_fetch_person_data_case_insensitive(self):\n    \"\"\"Test case-insensitive person lookup\"\"\"\n    result = await fetch_person(name=\"john doe\")\n    assert \"John Doe\" in result\n</code></pre></p> <p>Validates: - Case-insensitive lookups - Name normalization - Consistent retrieval</p> <p>Test: Not Found <pre><code>@pytest.mark.asyncio\nasync def test_fetch_person_data_nonexistent(self):\n    \"\"\"Test fetching a non-existent person\"\"\"\n    result = await fetch_person(name=\"Nonexistent Person\")\n    assert \"not found\" in result.lower()\n</code></pre></p> <p>Validates: - Error handling - Clear error messages - Graceful failures</p>"},{"location":"testing/#linking-tool-tests-6-tests","title":"Linking Tool Tests (6 tests)","text":"<p>Test: Create Relationship <pre><code>@pytest.mark.asyncio\nasync def test_link_entities_create_relationship(self):\n    \"\"\"Test creating a relationship between entities\"\"\"\n    result = await link_entities(\n        from_entity=\"Alice\",\n        to_entity=\"Bob\",\n        relationship_type=\"FRIEND_OF\"\n    )\n    assert \"created\" in result.lower() or \"alice\" in result.lower()\n</code></pre></p> <p>Validates: - Relationship creation - Entity linking - Relationship types</p> <p>Test: Get Context <pre><code>@pytest.mark.asyncio\nasync def test_get_entity_context(self):\n    \"\"\"Test getting context for an entity\"\"\"\n    result = await get_entity_context(entity_name=\"Alice\")\n    assert \"Alice\" in result\n    assert \"relationships\" in result.lower() or \"connected\" in result.lower()\n</code></pre></p> <p>Validates: - Context retrieval - Relationship traversal - Graph queries</p> <p>Test: Bidirectional Relationships <pre><code>@pytest.mark.asyncio\nasync def test_link_entities_bidirectional(self):\n    \"\"\"Test that relationships are queryable in both directions\"\"\"\n    await link_entities(\"Alice\", \"Charlie\", \"WORKS_WITH\")\n\n    alice_context = await get_entity_context(\"Alice\")\n    charlie_context = await get_entity_context(\"Charlie\")\n\n    assert \"Charlie\" in alice_context\n    assert \"Alice\" in charlie_context\n</code></pre></p> <p>Validates: - Bidirectional queries - Graph traversal - Relationship symmetry</p>"},{"location":"testing/#cross-tool-integration-test-1-test","title":"Cross-Tool Integration Test (1 test)","text":"<p>Test: End-to-End Workflow <pre><code>@pytest.mark.asyncio\nasync def test_cross_tool_workflow(self):\n    \"\"\"Test complete workflow across tools\"\"\"\n    # Create person\n    await update_person(name=\"David Smith\", age=35)\n\n    # Link to another person\n    await link_entities(\"David Smith\", \"Alice\", \"COLLEAGUE_OF\")\n\n    # Fetch person data\n    person_result = await fetch_person(\"David Smith\")\n    assert \"David Smith\" in person_result\n\n    # Get relationship context\n    context_result = await get_entity_context(\"David Smith\")\n    assert \"Alice\" in context_result\n</code></pre></p> <p>Validates: - Multi-tool workflows - Data consistency - End-to-end functionality</p> <p>Prerequisites: - Neo4j must be running: <code>docker compose up -d neo4j</code> - No MCP server required (tests tools directly)</p>"},{"location":"testing/#writing-tests","title":"Writing Tests","text":""},{"location":"testing/#test-structure","title":"Test Structure","text":"<pre><code>import pytest\nfrom src.python.tools.personalDataTool import fetch_person, update_person\n\n@pytest.mark.asyncio  # Required for async tests\nasync def test_my_feature():\n    \"\"\"Clear description of what this tests\"\"\"\n    # Arrange: Set up test data\n    await update_person(name=\"Test User\", age=25)\n\n    # Act: Perform action\n    result = await fetch_person(\"Test User\")\n\n    # Assert: Verify result\n    assert \"Test User\" in result\n    assert \"25\" in result\n</code></pre>"},{"location":"testing/#best-practices","title":"Best Practices","text":"<ol> <li>Use descriptive names: <code>test_fetch_person_returns_error_for_nonexistent_user</code></li> <li>One assertion per concept: Test one behavior at a time</li> <li>Clean up data: Use fixtures for setup/teardown</li> <li>Test edge cases: Empty inputs, special characters, large data</li> <li>Test error conditions: Not just happy paths</li> </ol>"},{"location":"testing/#test-fixtures","title":"Test Fixtures","text":"<p>Create reusable test data:</p> <pre><code>@pytest.fixture\nasync def sample_person():\n    \"\"\"Create a sample person for testing\"\"\"\n    await update_person(\n        name=\"Test Person\",\n        age=30,\n        email=\"test@example.com\"\n    )\n    yield \"Test Person\"\n    # Cleanup if needed\n</code></pre> <p>Use in tests:</p> <pre><code>@pytest.mark.asyncio\nasync def test_something(sample_person):\n    result = await fetch_person(sample_person)\n    assert \"Test Person\" in result\n</code></pre>"},{"location":"testing/#cicd-integration","title":"CI/CD Integration","text":"<p>Tests run automatically on every push and pull request via GitHub Actions.</p> <p>Test job workflow: <pre><code>- name: Start services\n  run: docker compose up -d neo4j mcp\n\n- name: Run MCP tests\n  run: docker compose run --rm pytest pytest /app/test/python/test_mcp_integration.py -v\n\n- name: Run tool tests\n  run: docker compose run --rm pytest pytest /app/test/python/test_tools.py -v\n\n- name: Generate coverage\n  run: docker compose run --rm pytest pytest /app/test/python/ -v --cov\n</code></pre></p> <p>See CI/CD Pipeline \u2192 for full details.</p>"},{"location":"testing/#troubleshooting","title":"Troubleshooting","text":""},{"location":"testing/#tests-hang-or-timeout","title":"Tests Hang or Timeout","text":"<p>Cause: Services not running or not initialized</p> <p>Solution: <pre><code># Check service status\ndocker compose ps\n\n# View logs\ndocker compose logs neo4j\ndocker compose logs mcp\n\n# Restart services\ndocker compose restart neo4j mcp\n</code></pre></p>"},{"location":"testing/#neo4j-connection-errors","title":"Neo4j Connection Errors","text":"<p>Cause: Neo4j not ready or wrong credentials</p> <p>Solution: <pre><code># Wait for Neo4j to initialize\nsleep 15\n\n# Check Neo4j logs\ndocker compose logs neo4j | grep \"Started\"\n\n# Verify credentials in .env\nNEO4J_USER=neo4j\nNEO4J_PASSWORD=personamate\n</code></pre></p>"},{"location":"testing/#mcp-integration-tests-fail","title":"MCP Integration Tests Fail","text":"<p>Cause: MCP server not running</p> <p>Solution: <pre><code># Start MCP server\ndocker compose up -d mcp\n\n# Wait for startup\nsleep 5\n\n# Verify MCP server\ncurl http://localhost:8080/health\n</code></pre></p>"},{"location":"testing/#import-errors","title":"Import Errors","text":"<p>Cause: Python path not set correctly</p> <p>Solution: <pre><code># Add src to PYTHONPATH\nexport PYTHONPATH=\"${PYTHONPATH}:/app/src/python\"\n\n# Or run via Docker (recommended)\ndocker compose run --rm pytest pytest /app/test/python/ -v\n</code></pre></p>"},{"location":"testing/#test-data-persists-between-runs","title":"Test Data Persists Between Runs","text":"<p>Cause: Neo4j database not cleared</p> <p>Solution: <pre><code># Clear Neo4j data\ndocker compose down -v\ndocker compose up -d neo4j\n\n# Wait for initialization\nsleep 15\n</code></pre></p>"},{"location":"testing/#next-steps","title":"Next Steps","text":"<ul> <li>CI/CD Pipeline \u2192 Understand automated testing</li> <li>Contributing Guide \u2192 Learn development workflow</li> <li>MCP Tools \u2192 Explore available MCP tools</li> </ul>"},{"location":"workflows/","title":"CI/CD Pipeline","text":"<p>PersonaMate uses GitHub Actions for automated testing, code quality enforcement, and continuous integration.</p>"},{"location":"workflows/#pipeline-overview","title":"Pipeline Overview","text":"<p>The CI/CD pipeline runs on every push and pull request to <code>main</code> and <code>dev</code> branches. Jobs are executed conditionally based on which files changed, improving efficiency.</p> <pre><code>graph LR\n    A[Push/PR] --&gt; B[Detect Changes]\n    B --&gt;|Python changed| C[Test Job]\n    B --&gt;|Python changed| D[Lint Job]\n    B --&gt;|Docs changed| E[Docs Job]\n    C --&gt; F{All Pass?}\n    D --&gt; F\n    E --&gt; F\n    F --&gt;|Yes + main| G[Build Job]\n    F --&gt;|No| H[Fail]</code></pre>"},{"location":"workflows/#conditional-execution","title":"Conditional Execution","text":"<p>Jobs run only when relevant files change:</p> Job Triggers On test <code>src/python/**</code>, <code>test/python/**</code>, <code>requirements.txt</code>, <code>docker-compose.yml</code>, <code>Dockerfile</code> lint <code>src/python/**</code>, <code>test/python/**</code> docs <code>docs/**</code>, <code>mkdocs.yml</code>, <code>README.md</code> build Always runs on <code>main</code> after all jobs pass/skip <p>Benefits: - \u26a1 Faster CI runs (skip irrelevant jobs) - \ud83d\udcb0 Reduced GitHub Actions minutes - \ud83c\udfaf Clear feedback on what changed - \u2705 Still runs all jobs on pull requests</p> <p>Force run all jobs: - Create a pull request (always runs everything) - Push to <code>main</code> branch (runs build job) - Modify <code>.github/workflows/</code> (triggers all)</p>"},{"location":"workflows/#pipeline-jobs","title":"Pipeline Jobs","text":""},{"location":"workflows/#1-test-job","title":"1. \ud83e\uddea Test Job","text":"<p>Runs all automated tests in a Docker environment to validate functionality.</p> <p>What it does: - Starts Neo4j database - Starts MCP server using FastMCP - Runs MCP integration tests (6 tests) - Runs tool implementation tests (14 tests) - Generates code coverage report - Uploads coverage to Codecov</p> <p>Test suites: - MCP Integration Tests: Validates MCP server initialization, tool listing, resource reading, and protocol compliance - Tool Implementation Tests: Tests all CRUD operations for persons and relationships, including cross-tool workflows</p> <p>Requirements: - Neo4j service must be running - MCP server must be started before integration tests - Environment variables from GitHub Secrets (<code>OPENAI_API_KEY</code>)</p> <p>Test execution: <pre><code>- name: Run MCP integration tests\n  run: docker compose run --rm pytest pytest /app/test/python/test_mcp_integration.py -v\n\n- name: Run tool tests\n  run: docker compose run --rm pytest pytest /app/test/python/test_tools.py -v\n\n- name: Run all tests with coverage\n  run: docker compose run --rm pytest pytest /app/test/python/ --cov=/app/src/python --cov-branch --cov-report=xml --cov-report=term -v\n\n- name: Upload coverage to Codecov\n  uses: codecov/codecov-action@v4\n  with:\n    file: ./coverage.xml\n    token: ${{ secrets.CODECOV_TOKEN }}\n</code></pre></p> <p>Coverage reporting: - Uses <code>pytest-cov</code> for coverage collection - Includes branch coverage with <code>--cov-branch</code> - Generates XML report for Codecov - Uploads to codecov.io for tracking - Badge available in README</p>"},{"location":"workflows/#2-lint-job","title":"2. \ud83d\udc85 Lint Job","text":"<p>Enforces code quality and automatically formats code using black.</p> <p>What it does: - Checks for syntax errors using flake8 - Auto-formats Python code with black (120 char line length) - Commits formatting changes on push events (with <code>[skip ci]</code> tag) - Shows formatting preview on pull requests (no commit)</p> <p>Auto-formatting behavior:</p> On PushOn Pull Request <pre><code>- name: Format with black\n  run: black src/python test/python --line-length=120\n\n- name: Commit changes\n  run: |\n    git config user.name \"github-actions[bot]\"\n    git config user.email \"github-actions[bot]@users.noreply.github.com\"\n    git add -A\n    git diff-index --quiet HEAD || git commit -m \"style: auto-format code with black [skip ci]\"\n    git push\n</code></pre> <pre><code>- name: Format with black\n  run: black src/python test/python --line-length=120 --check --diff\n</code></pre> <p>Formatting rules: - Line length: 120 characters - Style: Black default (PEP 8 compliant) - Import sorting: isort with black profile - Trailing whitespace removed - Single newline at end of file</p>"},{"location":"workflows/#3-docs-job","title":"3. \ud83d\udcda Docs Job","text":"<p>Validates documentation builds correctly with no broken links.</p> <p>What it does: - Installs MkDocs with Material theme - Builds documentation with strict mode - Fails if any broken links or errors found - Verifies site structure</p> <p>Build steps: <pre><code>- name: Install MkDocs dependencies\n  run: pip install mkdocs mkdocs-material mkdocs-git-revision-date-localized-plugin\n\n- name: Build documentation\n  run: mkdocs build --strict\n</code></pre></p> <p>Validation: - <code>--strict</code> flag ensures build fails on warnings - Catches broken internal links - Validates navigation structure - Checks for missing files</p>"},{"location":"workflows/#4-build-job","title":"4. \ud83c\udfd7\ufe0f Build Job","text":"<p>Validates deployment readiness (only runs on <code>main</code> branch after tests pass).</p> <p>What it does: - Builds Docker images - Starts all services (Neo4j, MCP, OpenWebUI) - Performs smoke test - Validates deployment configuration</p> <p>Build steps: <pre><code>- name: Build services\n  run: docker compose build\n\n- name: Start services\n  run: docker compose up -d\n\n- name: Validate deployment\n  run: docker compose ps\n</code></pre></p>"},{"location":"workflows/#required-github-secrets","title":"Required GitHub Secrets","text":"<p>Configure these secrets in your repository settings:</p> Secret Purpose Required <code>OPENAI_API_KEY</code> OpenAI API key for LLM functionality Yes <code>CODECOV_TOKEN</code> Codecov upload token for coverage reports Yes <code>LANGCHAIN_API_KEY</code> LangChain tracing API key Optional <p>How to add secrets: 1. Go to repository <code>Settings</code> 2. Navigate to <code>Secrets and variables</code> \u2192 <code>Actions</code> 3. Click <code>New repository secret</code> 4. Add name and value</p>"},{"location":"workflows/#local-development-workflow","title":"Local Development Workflow","text":""},{"location":"workflows/#running-tests-locally","title":"Running Tests Locally","text":"<p>Match the CI environment by using Docker:</p> <pre><code># Start services\ndocker compose up -d neo4j mcp\n\n# Wait for initialization\nsleep 15\n\n# Run MCP integration tests\ndocker compose run --rm pytest pytest /app/test/python/test_mcp_integration.py -v\n\n# Run tool tests\ndocker compose run --rm pytest pytest /app/test/python/test_tools.py -v\n\n# Run all tests with coverage (including branch coverage)\ndocker compose run --rm pytest pytest /app/test/python/ --cov=/app/src/python --cov-branch --cov-report=xml --cov-report=term -v\n\n# View coverage report\ncat coverage.xml\n</code></pre> <p>Setup Codecov locally: <pre><code># Install codecov CLI (optional)\npip install codecov\n\n# Upload coverage manually\ncodecov -t YOUR_CODECOV_TOKEN\n</code></pre></p>"},{"location":"workflows/#code-formatting-locally","title":"Code Formatting Locally","text":""},{"location":"workflows/#option-1-pre-commit-hooks-recommended","title":"Option 1: Pre-commit Hooks (Recommended)","text":"<p>Install pre-commit hooks for automatic formatting:</p> <pre><code># Install pre-commit\npip install pre-commit\n\n# Install git hooks\npre-commit install\n\n# Now hooks run automatically on git commit!\n</code></pre> <p>Pre-commit will: - Format code with black - Sort imports with isort - Check with flake8 - Remove trailing whitespace - Ensure single newline at end of file</p>"},{"location":"workflows/#option-2-manual-formatting","title":"Option 2: Manual Formatting","text":"<p>Format code manually before committing:</p> <pre><code># Format all Python files\nblack src/python test/python --line-length=120\n\n# Check what would be formatted (without changing files)\nblack src/python test/python --line-length=120 --check\n\n# Run all pre-commit hooks manually\npre-commit run --all-files\n</code></pre>"},{"location":"workflows/#workflow-triggers","title":"Workflow Triggers","text":"<p>The pipeline uses path-based filtering for efficient execution:</p> <pre><code>on:\n  push:\n    branches: [ main, dev ]\n  pull_request:\n    branches: [ main, dev ]\n\njobs:\n  changes:\n    # Detects which files changed\n    outputs:\n      python: ${{ steps.filter.outputs.python }}\n      docs: ${{ steps.filter.outputs.docs }}\n      docker: ${{ steps.filter.outputs.docker }}\n</code></pre> <p>Path filters: <pre><code>filters:\n  python:\n    - 'src/python/**'\n    - 'test/python/**'\n    - 'requirements.txt'\n  docs:\n    - 'docs/**'\n    - 'mkdocs.yml'\n    - 'README.md'\n  docker:\n    - 'docker-compose.yml'\n    - 'Dockerfile'\n</code></pre></p> <p>Behavior: - Push to main/dev: Runs jobs based on changed files - Pull request: Runs all jobs for complete validation - Build job: Only runs on <code>main</code> branch pushes after all jobs pass</p>"},{"location":"workflows/#status-badges","title":"Status Badges","text":"<p>Track pipeline status with badges:</p> <pre><code>![CI/CD Pipeline](https://github.com/enrodrigu/PersonaMate/workflows/CI%2FCD%20Pipeline/badge.svg)\n[![codecov](https://codecov.io/gh/enrodrigu/PersonaMate/branch/main/graph/badge.svg)](https://codecov.io/gh/enrodrigu/PersonaMate)\n</code></pre>"},{"location":"workflows/#troubleshooting","title":"Troubleshooting","text":""},{"location":"workflows/#tests-fail-in-ci-but-pass-locally","title":"Tests Fail in CI but Pass Locally","text":"<p>Cause: Environment differences between local and CI</p> <p>Solution: - Use Docker locally: <code>docker compose run --rm pytest pytest /app/test/python/ -v</code> - Check GitHub Secrets are set correctly - Ensure MCP server starts before integration tests</p>"},{"location":"workflows/#auto-format-creates-unnecessary-commits","title":"Auto-format Creates Unnecessary Commits","text":"<p>Cause: Code not formatted before push</p> <p>Solution: - Install pre-commit hooks: <code>pre-commit install</code> - Format manually before commit: <code>black src/python test/python --line-length=120</code></p>"},{"location":"workflows/#build-job-fails","title":"Build Job Fails","text":"<p>Cause: Only runs on <code>main</code> branch</p> <p>Solution: - Build job is expected to be skipped on non-main branches - Test locally with: <code>docker compose build &amp;&amp; docker compose up -d</code></p>"},{"location":"workflows/#coverage-report-missing","title":"Coverage Report Missing","text":"<p>Cause: Tests failed or coverage upload failed</p> <p>Solution: - Check test job logs for failures - Verify Codecov integration is enabled - Ensure coverage is generated: <code>--cov=/app/src/python --cov-report=term</code></p>"},{"location":"workflows/#next-steps","title":"Next Steps","text":"<ul> <li>Testing Guide \u2192 Learn how to write and run tests</li> <li>Contributing Guide \u2192 Start contributing to PersonaMate</li> <li>Project Structure \u2192 Understand the codebase organization</li> </ul>"},{"location":"mcp/resources/","title":"MCP Resources Reference","text":"<p>PersonaMate exposes read-only data through MCP resources. Resources provide structured access to graph data without modifying it, making them ideal for querying and exploration.</p> <p>MCP Protocol Interface</p> <p>Resources are accessed via Model Context Protocol, not HTTP URLs. The <code>graph://</code> URI scheme is an MCP resource identifier, not a web URL. See MCP Protocol for details.</p>"},{"location":"mcp/resources/#resource-overview","title":"Resource Overview","text":"Resource URI Description Content Type Format <code>graph://persons</code> List all persons text/plain JSON array <code>graph://relationships</code> List all relationships text/plain JSON array <code>graph://stats</code> Graph statistics text/plain JSON object"},{"location":"mcp/resources/#graphpersons","title":"graph://persons","text":"<p>Retrieve a list of all persons in the knowledge graph.</p>"},{"location":"mcp/resources/#uri","title":"URI","text":"<pre><code>graph://persons\n</code></pre>"},{"location":"mcp/resources/#response-format","title":"Response Format","text":"<p>Returns a JSON array of person objects:</p> <pre><code>[\n  {\n    \"name\": \"Alice Johnson\",\n    \"age\": 35,\n    \"email\": \"alice@example.com\",\n    \"phone\": \"555-0101\",\n    \"address\": {\n      \"street\": \"456 Oak Ave\",\n      \"city\": \"Cambridge\",\n      \"state\": \"MA\",\n      \"zip\": \"02139\"\n    }\n  },\n  {\n    \"name\": \"Bob Smith\",\n    \"age\": 42,\n    \"email\": \"bob@example.com\",\n    \"phone\": \"555-0102\",\n    \"address\": {\n      \"street\": \"789 Pine St\",\n      \"city\": \"Boston\",\n      \"state\": \"MA\",\n      \"zip\": \"02101\"\n    }\n  }\n]\n</code></pre>"},{"location":"mcp/resources/#mcp-client-usage","title":"MCP Client Usage","text":"<pre><code># Read resource\nresult = await client.read_resource(\"graph://persons\")\npersons = json.loads(result.contents[0].text)\n\nprint(f\"Found {len(persons)} persons\")\nfor person in persons:\n    print(f\"- {person['name']} (age {person['age']})\")\n</code></pre>"},{"location":"mcp/resources/#cypher-query","title":"Cypher Query","text":"<p>Internally executes:</p> <pre><code>MATCH (p:Person)\nRETURN p.name as name,\n       p.age as age,\n       p.email as email,\n       p.phone as phone,\n       p.address as address\nORDER BY p.name\n</code></pre>"},{"location":"mcp/resources/#use-cases","title":"Use Cases","text":"<ul> <li>Directory listing: Display all contacts</li> <li>Search index: Build searchable person list</li> <li>Export data: Backup or migrate persons</li> <li>Analytics: Analyze person demographics</li> </ul>"},{"location":"mcp/resources/#implementation-details","title":"Implementation Details","text":"<p>Source: <code>src/python/mcp_server.py</code></p> <pre><code>@mcp.resource(\"graph://persons\")\ndef get_all_persons() -&gt; str:\n    \"\"\"List all persons in the graph\"\"\"\n    g = Neo4jGraph.load()\n    try:\n        with g._driver.session(database=g._database) as session:\n            result = session.run(\"MATCH (p:Person) RETURN p ORDER BY p.name\")\n            persons = []\n            for record in result:\n                node = record[\"p\"]\n                person_dict = dict(node)\n                # Parse JSON address if stored as string\n                if \"address\" in person_dict and isinstance(person_dict[\"address\"], str):\n                    person_dict[\"address\"] = json.loads(person_dict[\"address\"])\n                persons.append(person_dict)\n            return json.dumps(persons, indent=2)\n    finally:\n        g.close()\n</code></pre>"},{"location":"mcp/resources/#graphrelationships","title":"graph://relationships","text":"<p>Retrieve all relationships between entities in the knowledge graph.</p>"},{"location":"mcp/resources/#uri_1","title":"URI","text":"<pre><code>graph://relationships\n</code></pre>"},{"location":"mcp/resources/#response-format_1","title":"Response Format","text":"<p>Returns a JSON array of relationship objects:</p> <pre><code>[\n  {\n    \"from\": \"Alice Johnson\",\n    \"to\": \"Bob Smith\",\n    \"type\": \"FRIEND_OF\",\n    \"properties\": {}\n  },\n  {\n    \"from\": \"Bob Smith\",\n    \"to\": \"Charlie Davis\",\n    \"type\": \"WORKS_WITH\",\n    \"properties\": {\n      \"since\": \"2020-01-15\",\n      \"department\": \"Engineering\"\n    }\n  },\n  {\n    \"from\": \"Alice Johnson\",\n    \"to\": \"Charlie Davis\",\n    \"type\": \"MANAGES\",\n    \"properties\": {}\n  }\n]\n</code></pre>"},{"location":"mcp/resources/#mcp-client-usage_1","title":"MCP Client Usage","text":"<pre><code># Read resource\nresult = await client.read_resource(\"graph://relationships\")\nrelationships = json.loads(result.contents[0].text)\n\nprint(f\"Found {len(relationships)} relationships\")\nfor rel in relationships:\n    print(f\"- {rel['from']} -[{rel['type']}]-&gt; {rel['to']}\")\n</code></pre>"},{"location":"mcp/resources/#cypher-query_1","title":"Cypher Query","text":"<p>Internally executes:</p> <pre><code>MATCH (a:Person)-[r]-&gt;(b:Person)\nRETURN a.name as from,\n       type(r) as type,\n       b.name as to,\n       properties(r) as properties\nORDER BY a.name, type(r), b.name\n</code></pre>"},{"location":"mcp/resources/#use-cases_1","title":"Use Cases","text":"<ul> <li>Network visualization: Build relationship graphs</li> <li>Social network analysis: Analyze connection patterns</li> <li>Relationship discovery: Find indirect connections</li> <li>Data export: Backup relationship data</li> </ul>"},{"location":"mcp/resources/#common-relationship-types","title":"Common Relationship Types","text":"Type Description Example <code>FRIEND_OF</code> Personal friendship Alice \u2192 Bob <code>FAMILY_OF</code> Family connection John \u2192 Jane <code>WORKS_WITH</code> Professional colleague Bob \u2192 Charlie <code>MANAGES</code> Manager-report Alice \u2192 Charlie <code>KNOWS</code> General acquaintance Any \u2192 Any <code>COLLEAGUE_OF</code> Work relationship Team members <code>PARTNER_OF</code> Business partner Business relations"},{"location":"mcp/resources/#implementation-details_1","title":"Implementation Details","text":"<p>Source: <code>src/python/mcp_server.py</code></p> <pre><code>@mcp.resource(\"graph://relationships\")\ndef get_all_relationships() -&gt; str:\n    \"\"\"List all relationships in the graph\"\"\"\n    g = Neo4jGraph.load()\n    try:\n        with g._driver.session(database=g._database) as session:\n            result = session.run(\"\"\"\n                MATCH (a:Person)-[r]-&gt;(b:Person)\n                RETURN a.name as from,\n                       type(r) as type,\n                       b.name as to,\n                       properties(r) as properties\n                ORDER BY a.name, type(r), b.name\n            \"\"\")\n            relationships = []\n            for record in result:\n                relationships.append({\n                    \"from\": record[\"from\"],\n                    \"to\": record[\"to\"],\n                    \"type\": record[\"type\"],\n                    \"properties\": dict(record[\"properties\"])\n                })\n            return json.dumps(relationships, indent=2)\n    finally:\n        g.close()\n</code></pre>"},{"location":"mcp/resources/#graphstats","title":"graph://stats","text":"<p>Get statistical information about the knowledge graph.</p>"},{"location":"mcp/resources/#uri_2","title":"URI","text":"<pre><code>graph://stats\n</code></pre>"},{"location":"mcp/resources/#response-format_2","title":"Response Format","text":"<p>Returns a JSON object with graph statistics:</p> <pre><code>{\n  \"persons\": {\n    \"total\": 150,\n    \"with_email\": 142,\n    \"with_phone\": 138,\n    \"with_address\": 145,\n    \"avg_age\": 35.4\n  },\n  \"relationships\": {\n    \"total\": 324,\n    \"by_type\": {\n      \"FRIEND_OF\": 180,\n      \"WORKS_WITH\": 95,\n      \"FAMILY_OF\": 32,\n      \"MANAGES\": 17\n    }\n  },\n  \"network\": {\n    \"avg_connections_per_person\": 2.16,\n    \"most_connected\": {\n      \"name\": \"Alice Johnson\",\n      \"connections\": 12\n    },\n    \"isolated_persons\": 5\n  },\n  \"metadata\": {\n    \"database\": \"neo4j\",\n    \"last_updated\": \"2024-01-15T10:30:00Z\"\n  }\n}\n</code></pre>"},{"location":"mcp/resources/#mcp-client-usage_2","title":"MCP Client Usage","text":"<pre><code># Read resource\nresult = await client.read_resource(\"graph://stats\")\nstats = json.loads(result.contents[0].text)\n\nprint(f\"Total persons: {stats['persons']['total']}\")\nprint(f\"Total relationships: {stats['relationships']['total']}\")\nprint(f\"Most connected: {stats['network']['most_connected']['name']}\")\n</code></pre>"},{"location":"mcp/resources/#cypher-queries","title":"Cypher Queries","text":"<p>Multiple queries to gather statistics:</p> <p>Person count: <pre><code>MATCH (p:Person) RETURN count(p) as total\n</code></pre></p> <p>Relationship counts by type: <pre><code>MATCH ()-[r]-&gt;()\nRETURN type(r) as type, count(r) as count\nORDER BY count DESC\n</code></pre></p> <p>Most connected person: <pre><code>MATCH (p:Person)-[r]-()\nRETURN p.name as name, count(r) as connections\nORDER BY connections DESC\nLIMIT 1\n</code></pre></p>"},{"location":"mcp/resources/#use-cases_2","title":"Use Cases","text":"<ul> <li>Dashboard metrics: Display key statistics</li> <li>Health monitoring: Track graph growth</li> <li>Data quality: Identify incomplete records</li> <li>Analytics: Understand network structure</li> </ul>"},{"location":"mcp/resources/#implementation-details_2","title":"Implementation Details","text":"<p>Source: <code>src/python/mcp_server.py</code></p> <pre><code>@mcp.resource(\"graph://stats\")\ndef get_graph_stats() -&gt; str:\n    \"\"\"Get statistical information about the graph\"\"\"\n    g = Neo4jGraph.load()\n    try:\n        with g._driver.session(database=g._database) as session:\n            # Count persons\n            person_count = session.run(\"MATCH (p:Person) RETURN count(p) as total\").single()[\"total\"]\n\n            # Count relationships by type\n            rel_result = session.run(\"\"\"\n                MATCH ()-[r]-&gt;()\n                RETURN type(r) as type, count(r) as count\n                ORDER BY count DESC\n            \"\"\")\n            rel_by_type = {rec[\"type\"]: rec[\"count\"] for rec in rel_result}\n\n            # Most connected person\n            most_connected = session.run(\"\"\"\n                MATCH (p:Person)-[r]-()\n                RETURN p.name as name, count(r) as connections\n                ORDER BY connections DESC\n                LIMIT 1\n            \"\"\").single()\n\n            stats = {\n                \"persons\": {\"total\": person_count},\n                \"relationships\": {\n                    \"total\": sum(rel_by_type.values()),\n                    \"by_type\": rel_by_type\n                },\n                \"network\": {\n                    \"most_connected\": dict(most_connected) if most_connected else None\n                }\n            }\n            return json.dumps(stats, indent=2)\n    finally:\n        g.close()\n</code></pre>"},{"location":"mcp/resources/#mcp-prompts","title":"MCP Prompts","text":"<p>PersonaMate also exposes predefined prompts for common operations.</p>"},{"location":"mcp/resources/#person_lookup_prompt","title":"person_lookup_prompt","text":"<p>Generate a comprehensive prompt for looking up person information.</p> <p>Prompt name: <code>person_lookup_prompt</code></p> <p>Arguments: - <code>name</code> (string, required): Person's name to look up</p> <p>Template: <pre><code>Please fetch comprehensive information about {name}, including:\n- Basic details (age, email, phone, address)\n- All relationships and connections\n- Context about their network\n\nUse the fetch_person and get_entity_context tools to gather complete information.\n</code></pre></p> <p>Usage: <pre><code>result = await client.get_prompt(\"person_lookup_prompt\", arguments={\"name\": \"Alice Johnson\"})\nprompt_text = result.messages[0].content.text\n</code></pre></p>"},{"location":"mcp/resources/#relationship_analysis_prompt","title":"relationship_analysis_prompt","text":"<p>Generate a prompt for analyzing relationships between people.</p> <p>Prompt name: <code>relationship_analysis_prompt</code></p> <p>Arguments: - <code>person1</code> (string, required): First person's name - <code>person2</code> (string, required): Second person's name</p> <p>Template: <pre><code>Analyze the relationship between {person1} and {person2}:\n- Direct relationships\n- Mutual connections\n- Shortest path between them\n- Shared attributes or interests\n\nUse get_entity_context for both persons and identify connections.\n</code></pre></p> <p>Usage: <pre><code>result = await client.get_prompt(\n    \"relationship_analysis_prompt\",\n    arguments={\"person1\": \"Alice\", \"person2\": \"Bob\"}\n)\nprompt_text = result.messages[0].content.text\n</code></pre></p>"},{"location":"mcp/resources/#resource-discovery","title":"Resource Discovery","text":""},{"location":"mcp/resources/#list-all-resources","title":"List All Resources","text":"<pre><code># MCP client\nresult = await client.list_resources()\nfor resource in result.resources:\n    print(f\"{resource.uri}: {resource.name}\")\n    print(f\"  {resource.description}\")\n    print(f\"  MIME: {resource.mimeType}\")\n</code></pre> <p>Output: <pre><code>graph://persons: All Persons\n  List all persons in the knowledge graph\n  MIME: text/plain\n\ngraph://relationships: All Relationships\n  List all relationships between entities\n  MIME: text/plain\n\ngraph://stats: Graph Statistics\n  Statistical information about the graph\n  MIME: text/plain\n</code></pre></p>"},{"location":"mcp/resources/#resource-templates","title":"Resource Templates","text":"<p>Resources can use URI templates for parameterized access (future enhancement):</p> <pre><code>graph://person/{name}        # Specific person\ngraph://person/{name}/friends # Person's friends\ngraph://search?q={query}     # Search persons\n</code></pre>"},{"location":"mcp/resources/#testing","title":"Testing","text":"<p>Resources are tested in <code>test/python/test_mcp_integration.py</code>.</p> <p>Test resource reading: <pre><code>@pytest.mark.asyncio\nasync def test_read_resource():\n    \"\"\"Test reading a resource via MCP\"\"\"\n    result = await client.read_resource(\"graph://persons\")\n    assert len(result.contents) &gt; 0\n    assert result.contents[0].mimeType == \"text/plain\"\n\n    # Parse and validate\n    persons = json.loads(result.contents[0].text)\n    assert isinstance(persons, list)\n</code></pre></p> <p>Run resource tests: <pre><code>docker compose run --rm pytest pytest /app/test/python/test_mcp_integration.py::test_read_resource -v\n</code></pre></p>"},{"location":"mcp/resources/#performance-considerations","title":"Performance Considerations","text":""},{"location":"mcp/resources/#graphpersons_1","title":"graph://persons","text":"<ul> <li>Query complexity: O(n) where n = number of persons</li> <li>Memory usage: Loads all persons into memory</li> <li>Optimization: Add pagination for large graphs (&gt;1000 persons)</li> </ul> <p>Recommended limit: <pre><code>MATCH (p:Person) RETURN p ORDER BY p.name LIMIT 100\n</code></pre></p>"},{"location":"mcp/resources/#graphrelationships_1","title":"graph://relationships","text":"<ul> <li>Query complexity: O(n) where n = number of relationships</li> <li>Memory usage: Loads all relationships into memory</li> <li>Optimization: Filter by relationship type or person</li> </ul> <p>Filtered query: <pre><code>MATCH (a:Person)-[r:FRIEND_OF]-&gt;(b:Person)\nRETURN a.name, type(r), b.name\n</code></pre></p>"},{"location":"mcp/resources/#graphstats_1","title":"graph://stats","text":"<ul> <li>Query complexity: Multiple O(n) queries</li> <li>Memory usage: Minimal (aggregates only)</li> <li>Caching: Consider caching stats for 5-10 minutes</li> </ul>"},{"location":"mcp/resources/#error-handling","title":"Error Handling","text":"<p>Resources return empty results or error messages:</p> Condition Behavior Empty graph Returns empty array <code>[]</code> Database error Returns error message as text Connection failure MCP client raises exception"},{"location":"mcp/resources/#next-steps","title":"Next Steps","text":"<ul> <li>MCP Tools \u2192 Learn about MCP tools</li> <li>Testing \u2192 Test resources</li> <li>Contributing \u2192 Add new resources</li> </ul>"},{"location":"mcp/tools/","title":"MCP Tools Reference","text":"<p>PersonaMate exposes its functionality through Model Context Protocol (MCP) tools. These tools can be called by AI assistants and other MCP clients to manage personal data and relationships in the knowledge graph.</p> <p>Not a REST API</p> <p>PersonaMate uses the Model Context Protocol, not traditional HTTP REST endpoints. Tools are invoked via MCP protocol, not HTTP requests. See MCP Protocol for protocol details.</p>"},{"location":"mcp/tools/#tool-overview","title":"Tool Overview","text":"Tool Purpose Parameters Returns <code>fetch_person</code> Retrieve person information <code>name: str</code> Person data with graph context <code>update_person</code> Create or update person <code>name: str</code>, optional fields Success message <code>link_entities</code> Create relationship <code>from_entity: str</code>, <code>to_entity: str</code>, <code>relationship_type: str</code> Success message <code>get_entity_context</code> Get relationship context <code>entity_name: str</code>, optional <code>depth: int</code> JSON with nodes, edges, summary"},{"location":"mcp/tools/#fetch_person","title":"fetch_person","text":"<p>Retrieve comprehensive information about a person from the knowledge graph.</p>"},{"location":"mcp/tools/#function-signature","title":"Function Signature","text":"<pre><code>def fetch_person(name: str) -&gt; str\n</code></pre>"},{"location":"mcp/tools/#parameters","title":"Parameters","text":"Parameter Type Required Description <code>name</code> string Yes Person's name to look up (case-insensitive)"},{"location":"mcp/tools/#return-value","title":"Return Value","text":"<p>Returns a JSON string containing:</p> <pre><code>{\n  \"name\": \"John Doe\",\n  \"age\": 30,\n  \"email\": \"john@example.com\",\n  \"phone\": \"123-456-7890\",\n  \"address\": {\n    \"street\": \"123 Main St\",\n    \"city\": \"Boston\",\n    \"state\": \"MA\",\n    \"zip\": \"02101\"\n  },\n  \"graph_context\": [\n    {\n      \"name\": \"Jane Smith\",\n      \"labels\": [\"Person\"],\n      \"rel\": \"FRIEND_OF\",\n      \"direction\": \"out\"\n    }\n  ]\n}\n</code></pre> <p>If person not found: <code>\"Person not found\"</code></p>"},{"location":"mcp/tools/#features","title":"Features","text":"<ul> <li>Case-insensitive matching: \"john doe\" matches \"John Doe\"</li> <li>Normalized name matching: Handles diacritics and punctuation</li> <li>Graph context: Includes immediate neighbors and relationships</li> <li>Nested objects: Address stored as structured data</li> </ul>"},{"location":"mcp/tools/#example-usage","title":"Example Usage","text":"<p>Request: <pre><code>{\n  \"tool\": \"fetch_person\",\n  \"arguments\": {\n    \"name\": \"John Doe\"\n  }\n}\n</code></pre></p> <p>Response: <pre><code>{\n  \"name\": \"John Doe\",\n  \"age\": 30,\n  \"email\": \"john@example.com\",\n  \"graph_context\": [...]\n}\n</code></pre></p>"},{"location":"mcp/tools/#implementation-details","title":"Implementation Details","text":"<p>Source file: <code>src/python/tools/personalDataTool.py</code></p> <p>Name normalization: - Strips whitespace - Converts to lowercase - Removes diacritics (\u00e9 \u2192 e) - Removes punctuation - Collapses multiple spaces</p> <p>Cypher query: <pre><code>MATCH (p:Person) WHERE toLower(p.name) = $lower RETURN p LIMIT 1\n</code></pre></p> <p>Fallback strategy: If direct match fails, performs normalized comparison on all persons.</p>"},{"location":"mcp/tools/#update_person","title":"update_person","text":"<p>Create a new person or update an existing person's information in the knowledge graph.</p>"},{"location":"mcp/tools/#function-signature_1","title":"Function Signature","text":"<pre><code>def update_person(\n    name: str,\n    age: int = None,\n    email: str = None,\n    phone: str = None,\n    address: dict = None\n) -&gt; str\n</code></pre>"},{"location":"mcp/tools/#parameters_1","title":"Parameters","text":"Parameter Type Required Description <code>name</code> string Yes Person's name (case-sensitive for storage) <code>age</code> integer No Person's age <code>email</code> string No Email address <code>phone</code> string No Phone number <code>address</code> object No Address object with street, city, state, zip"},{"location":"mcp/tools/#return-value_1","title":"Return Value","text":"<p>Returns: <code>\"Person data updated\"</code></p> <p>If name is missing: <code>\"Name is required\"</code></p>"},{"location":"mcp/tools/#features_1","title":"Features","text":"<ul> <li>Upsert operation: Creates if doesn't exist, updates if exists</li> <li>Partial updates: Only specified fields are updated</li> <li>Nested objects: Address stored as JSON string internally</li> <li>Transaction safety: Uses Neo4j MERGE for atomic operations</li> </ul>"},{"location":"mcp/tools/#example-usage_1","title":"Example Usage","text":"<p>Create new person: <pre><code>{\n  \"tool\": \"update_person\",\n  \"arguments\": {\n    \"name\": \"Alice Johnson\",\n    \"age\": 35,\n    \"email\": \"alice@example.com\",\n    \"address\": {\n      \"street\": \"456 Oak Ave\",\n      \"city\": \"Cambridge\",\n      \"state\": \"MA\",\n      \"zip\": \"02139\"\n    }\n  }\n}\n</code></pre></p> <p>Update existing person (partial): <pre><code>{\n  \"tool\": \"update_person\",\n  \"arguments\": {\n    \"name\": \"Alice Johnson\",\n    \"age\": 36\n  }\n}\n</code></pre></p>"},{"location":"mcp/tools/#implementation-details_1","title":"Implementation Details","text":"<p>Source file: <code>src/python/tools/personalDataTool.py</code></p> <p>Cypher query: <pre><code>MERGE (p:Person {name: $name})\nSET p.age = $age, p.email = $email, p.address = $address\nRETURN p\n</code></pre></p> <p>Address storage: - Stored as JSON string: <code>json.dumps(address)</code> - Retrieved as object: <code>json.loads(address)</code> - Handles nested structure gracefully</p>"},{"location":"mcp/tools/#link_entities","title":"link_entities","text":"<p>Create a relationship between two entities in the knowledge graph.</p>"},{"location":"mcp/tools/#function-signature_2","title":"Function Signature","text":"<pre><code>def link_entities(\n    from_entity: str,\n    to_entity: str,\n    relationship_type: str\n) -&gt; str\n</code></pre>"},{"location":"mcp/tools/#parameters_2","title":"Parameters","text":"Parameter Type Required Description <code>from_entity</code> string Yes Source entity name <code>to_entity</code> string Yes Target entity name <code>relationship_type</code> string Yes Type of relationship (e.g., \"FRIEND_OF\", \"WORKS_WITH\")"},{"location":"mcp/tools/#return-value_2","title":"Return Value","text":"<p>Returns: <code>\"{from_entity} and {to_entity} linked with type {relationship_type}\"</code></p>"},{"location":"mcp/tools/#features_2","title":"Features","text":"<ul> <li>Dynamic relationship types: Any relationship type can be used</li> <li>Directed relationships: From source to target</li> <li>Creates nodes if missing: Entities created automatically if they don't exist</li> <li>Multiple relationships: Can create multiple relationships between same entities</li> </ul>"},{"location":"mcp/tools/#example-usage_2","title":"Example Usage","text":"<p>Create friendship: <pre><code>{\n  \"tool\": \"link_entities\",\n  \"arguments\": {\n    \"from_entity\": \"Alice\",\n    \"to_entity\": \"Bob\",\n    \"relationship_type\": \"FRIEND_OF\"\n  }\n}\n</code></pre></p> <p>Create work relationship: <pre><code>{\n  \"tool\": \"link_entities\",\n  \"arguments\": {\n    \"from_entity\": \"Alice\",\n    \"to_entity\": \"Charlie\",\n    \"relationship_type\": \"WORKS_WITH\"\n  }\n}\n</code></pre></p>"},{"location":"mcp/tools/#common-relationship-types","title":"Common Relationship Types","text":"Type Description Example <code>FRIEND_OF</code> Friendship Alice \u2192 Bob <code>FAMILY_OF</code> Family member John \u2192 Jane <code>WORKS_WITH</code> Colleague Alice \u2192 Charlie <code>MANAGES</code> Manager Bob \u2192 David <code>KNOWS</code> Acquaintance Alice \u2192 Eve"},{"location":"mcp/tools/#implementation-details_2","title":"Implementation Details","text":"<p>Source file: <code>src/python/tools/linkingTool.py</code></p> <p>Graph operation: <pre><code>graph.add_edge(\"Person\", from_entity, \"Person\", to_entity, relationship_type)\n</code></pre></p> <p>Cypher equivalent: <pre><code>MERGE (a:Person {name: $from_entity})\nMERGE (b:Person {name: $to_entity})\nMERGE (a)-[r:RELATIONSHIP_TYPE]-&gt;(b)\nRETURN r\n</code></pre></p>"},{"location":"mcp/tools/#get_entity_context","title":"get_entity_context","text":"<p>Retrieve rich relationship context for an entity, including multi-hop connections.</p>"},{"location":"mcp/tools/#function-signature_3","title":"Function Signature","text":"<pre><code>def get_entity_context(\n    entity_name: str,\n    depth: int = 1\n) -&gt; str\n</code></pre>"},{"location":"mcp/tools/#parameters_3","title":"Parameters","text":"Parameter Type Required Default Description <code>entity_name</code> string Yes - Entity name to get context for <code>depth</code> integer No 1 Maximum relationship depth (1-3 recommended)"},{"location":"mcp/tools/#return-value_3","title":"Return Value","text":"<p>Returns a JSON string containing:</p> <pre><code>{\n  \"entity\": {\n    \"name\": \"Alice\",\n    \"type\": \"Person\"\n  },\n  \"nodes\": [\n    {\"name\": \"Alice\", \"type\": \"Person\"},\n    {\"name\": \"Bob\", \"type\": \"Person\"},\n    {\"name\": \"Charlie\", \"type\": \"Person\"}\n  ],\n  \"edges\": [\n    {\n      \"from\": {\"name\": \"Alice\", \"type\": \"Person\"},\n      \"to\": {\"name\": \"Bob\", \"type\": \"Person\"},\n      \"rel\": \"FRIEND_OF\"\n    },\n    {\n      \"from\": {\"name\": \"Bob\", \"type\": \"Person\"},\n      \"to\": {\"name\": \"Charlie\", \"type\": \"Person\"},\n      \"rel\": \"WORKS_WITH\"\n    }\n  ],\n  \"summary\": \"Alice (Person) -[FRIEND_OF]-&gt; Bob (Person); Bob (Person) -[WORKS_WITH]-&gt; Charlie (Person)\"\n}\n</code></pre>"},{"location":"mcp/tools/#features_3","title":"Features","text":"<ul> <li>Breadth-first traversal: Explores graph systematically</li> <li>Multi-hop relationships: Configurable depth (1-3 hops)</li> <li>Structured output: Nodes, edges, and human-readable summary</li> <li>LLM-friendly: Summary format optimized for AI context</li> </ul>"},{"location":"mcp/tools/#example-usage_3","title":"Example Usage","text":"<p>Single-hop context: <pre><code>{\n  \"tool\": \"get_entity_context\",\n  \"arguments\": {\n    \"entity_name\": \"Alice\"\n  }\n}\n</code></pre></p> <p>Multi-hop context: <pre><code>{\n  \"tool\": \"get_entity_context\",\n  \"arguments\": {\n    \"entity_name\": \"Alice\",\n    \"depth\": 2\n  }\n}\n</code></pre></p>"},{"location":"mcp/tools/#use-cases","title":"Use Cases","text":"<ol> <li>Profile enrichment: Get all relationships for a person</li> <li>Network analysis: Understand connections between people</li> <li>Recommendation: Find mutual connections</li> <li>Context for LLM: Provide relationship context to AI</li> </ol>"},{"location":"mcp/tools/#implementation-details_3","title":"Implementation Details","text":"<p>Source file: <code>src/python/tools/linkingTool.py</code></p> <p>Algorithm: - Breadth-first search (BFS) from entity - Tracks visited nodes to avoid cycles - Builds nodes and edges collections - Generates human-readable summary</p> <p>Performance: - Depth 1: Direct connections only - Depth 2: Friends of friends - Depth 3+: May return large result sets</p>"},{"location":"mcp/tools/#error-handling","title":"Error Handling","text":"<p>All tools return descriptive error messages:</p> Tool Error Condition Message <code>fetch_person</code> Name empty <code>\"Person not found\"</code> <code>fetch_person</code> Person doesn't exist <code>\"Person not found\"</code> <code>update_person</code> Name empty <code>\"Name is required\"</code> <code>link_entities</code> Entity missing Creates entity automatically <code>get_entity_context</code> Entity doesn't exist Returns empty result"},{"location":"mcp/tools/#mcp-protocol-integration","title":"MCP Protocol Integration","text":""},{"location":"mcp/tools/#tool-registration","title":"Tool Registration","text":"<p>Tools are registered in <code>src/python/mcp_server.py</code>:</p> <pre><code>from fastmcp import FastMCP\nfrom tools.personalDataTool import fetch_person_data, update_person_data\nfrom tools.linkingTool import link_elements, fetch_entity_context\n\nmcp = FastMCP(\"personamate\")\n\n@mcp.tool()\nasync def fetch_person(name: str) -&gt; str:\n    return fetch_person_data(name)\n\n@mcp.tool()\nasync def update_person(name: str, **kwargs) -&gt; str:\n    return update_person_data(name, **kwargs)\n\n@mcp.tool()\nasync def link_entities(from_entity: str, to_entity: str, relationship_type: str) -&gt; str:\n    return link_elements(from_entity, \"Person\", to_entity, \"Person\", relationship_type)\n\n@mcp.tool()\nasync def get_entity_context(entity_name: str, depth: int = 1) -&gt; str:\n    return fetch_entity_context(entity_name, \"Person\", depth)\n</code></pre>"},{"location":"mcp/tools/#tool-discovery","title":"Tool Discovery","text":"<p>List available tools via MCP protocol:</p> <pre><code># MCP client\nresult = await client.list_tools()\nfor tool in result.tools:\n    print(f\"{tool.name}: {tool.description}\")\n</code></pre> <p>Output: <pre><code>fetch_person: Fetch personal information about a person by name from Neo4j\nupdate_person: Create or update a Person node in Neo4j with the provided properties\nlink_entities: Link two elements in the graph with a given link type\nget_entity_context: Fetch structured context for an entity from Neo4j\n</code></pre></p>"},{"location":"mcp/tools/#testing","title":"Testing","text":"<p>All tools have comprehensive test coverage in <code>test/python/test_tools.py</code>.</p> <p>Run tool tests: <pre><code>docker compose run --rm pytest pytest /app/test/python/test_tools.py -v\n</code></pre></p> <p>Test coverage: - 14 tool implementation tests - CRUD operations - Edge cases - Cross-tool workflows</p> <p>See Testing Guide \u2192 for details.</p>"},{"location":"mcp/tools/#next-steps","title":"Next Steps","text":"<ul> <li>MCP Resources \u2192 Learn about MCP resources</li> <li>Testing \u2192 Run and write tests</li> <li>Contributing \u2192 Add new tools</li> </ul>"}]}